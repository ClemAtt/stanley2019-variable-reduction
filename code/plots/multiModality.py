import numpy as np
import scipy as sp
import sys
import matplotlib.pyplot as plt
sys.dont_write_bytecode = True


if __name__ == "__main__":

    nTurbines = 100

    num = 200
    d_dx = np.linspace(2.,4.,num)
    d_dy = np.linspace(7.,9.,num)
    d_shear = np.linspace(-2.,2.,num)
    d_rot = np.linspace(-30.,30.,num)
    d_start = np.linspace(-1.5,1.5,num)

    AEP_dx = np.array([872013.77177027, 872097.9712696 , 872135.10907682, 872158.17025491,
       872161.09712706, 872191.50498914, 872239.58959301, 872239.55357416,
       872200.32060321, 872116.94474279, 872058.18386638, 872023.61911056,
       872020.717229  , 872035.19221311, 872063.15048729, 872110.74891972,
       872177.80170844, 872217.30869576, 872202.95446425, 872134.55304576,
       871980.21524026, 871804.1488036 , 871596.53472124, 871270.38039426,
       870930.34925711, 870606.8915653 , 870288.71393352, 869918.9514929 ,
       869564.08323191, 869263.65594723, 869026.68482608, 868715.15470098,
       868289.77553671, 867823.24707929, 867322.99540916, 866667.48455893,
       865958.30251514, 865113.99910316, 864055.56848943, 862789.70478458,
       861493.52459549, 860237.92178724, 859009.72273284, 857740.90991   ,
       856724.69038897, 855909.95801353, 855454.18204325, 855009.37724546,
       854609.30401324, 854258.44858512, 853966.59424969, 853838.01542408,
       853665.16394116, 853638.28355374, 853391.29809797, 853214.83797938,
       853245.89378424, 853355.16520284, 853573.10067412, 853844.03141942,
       854411.44595287, 855113.44766342, 855684.43538105, 856325.13180838,
       856966.15251958, 857653.29624854, 858153.70449236, 858470.36415653,
       858664.5120081 , 858772.94421802, 858817.03960112, 858792.90148445,
       858812.83112288, 858793.06013815, 858702.86999464, 858586.40305233,
       858424.98333315, 858095.06933839, 857493.14284635, 856545.15823422,
       855713.91436821, 854991.58625937, 854250.94963085, 853472.84797652,
       852716.1983296 , 852065.53312541, 851513.51806606, 851238.73485983,
       850861.27739076, 850500.37481926, 850275.82033805, 850335.85225092,
       850541.44812089, 850926.98608588, 851333.22800558, 852053.43703657,
       852898.60824725, 853776.29441296, 854723.70065669, 855532.25706068,
       856306.64983104, 856975.67930712, 857683.86857301, 858376.02136006,
       859019.12286362, 859793.07947072, 860638.31035682, 861491.42587122,
       862459.54286441, 863386.99363226, 864159.3446376 , 864789.06791403,
       865227.21777805, 865640.02591345, 865963.35210569, 866183.4326627 ,
       866356.05274413, 866479.30703793, 866546.73295503, 866453.8769284 ,
       866455.45833264, 866523.69657767, 866582.27537972, 866660.3410654 ,
       866586.80201974, 866357.93269475, 866158.52773287, 866024.96638451,
       865820.27058867, 865631.32839789, 865387.68069323, 865108.83297107,
       864708.61996016, 864224.71516602, 863676.93776236, 862922.16354616,
       862211.91503775, 861567.30524082, 860877.0859316 , 860162.53325693,
       859545.26802875, 859084.20200575, 858769.96938508, 858473.38290835,
       858413.84893795, 858311.00265432, 858260.05110844, 858331.43844983,
       858436.9284864 , 858777.54790799, 859226.29656268, 859968.25291111,
       860892.80690549, 861958.57349209, 863226.39394221, 864484.75132249,
       865705.46805264, 866911.27069226, 868136.55154708, 869247.20512146,
       870090.92915435, 870904.85227379, 871599.87577231, 872242.55963822,
       872901.87811498, 873565.45032735, 874235.36406264, 874957.73230676,
       875655.04055249, 876293.34402788, 876797.43229336, 877264.63051449,
       877706.4733415 , 878135.99465876, 878578.68082505, 879047.82688077,
       879486.90217716, 879801.76022379, 880067.52228739, 880337.28287423,
       880619.1513073 , 880896.27012738, 881223.44097007, 881629.49365559,
       882038.34778366, 882391.16127155, 882692.02077896, 883037.44474067,
       883406.4483937 , 883751.21713674, 884082.6392115 , 884394.34009763,
       884657.50667987, 884935.9562132 , 885181.21004139, 885315.11242042,
       885359.78906504, 885362.06552253, 885371.08844523, 885391.32409746])

    AEP_dy = np.array([871881.90756159, 871888.65664618, 871895.08096209, 871901.2258427 ,
       871907.17889694, 871912.99901273, 871918.63167876, 871924.03533885,
       871928.74346515, 871932.55709069, 871935.12437476, 871936.15079652,
       871935.76799494, 871933.42736795, 871929.23521088, 871923.26032672,
       871915.04657958, 871905.82065216, 871894.85600743, 871880.13365683,
       871861.41691267, 871837.26555336, 871809.62661466, 871781.21074181,
       871753.55572253, 871727.49525653, 871703.11357414, 871680.47582658,
       871659.84333372, 871641.15322326, 871624.61908816, 871610.59322295,
       871599.37143653, 871591.14953022, 871585.95259016, 871583.64180735,
       871582.97450679, 871583.39128135, 871584.42241831, 871585.26528471,
       871585.77648013, 871586.36176451, 871587.8242126 , 871591.44246714,
       871597.07115249, 871602.08968633, 871606.26652647, 871609.44569818,
       871611.64277182, 871612.86255181, 871613.32418121, 871614.20574071,
       871616.25038801, 871619.65215962, 871624.70510849, 871630.75451153,
       871636.79911682, 871642.26610839, 871647.4203765 , 871652.21173404,
       871655.25426086, 871658.08726207, 871663.23788242, 871670.52454322,
       871680.06535064, 871692.05975169, 871706.39156644, 871723.00358967,
       871741.72486868, 871762.28834409, 871784.55634431, 871808.65829473,
       871834.58310048, 871862.35533485, 871891.56749061, 871922.28512329,
       871954.53423878, 871988.92499498, 872025.32505977, 872063.38671968,
       872102.43842461, 872142.22428643, 872182.42923941, 872222.67222745,
       872263.10430828, 872304.06381945, 872345.20351489, 872386.19692583,
       872427.25699483, 872468.09611069, 872508.21910233, 872547.49350785,
       872585.48977875, 872621.84837135, 872655.78873572, 872686.89382852,
       872715.37362284, 872741.55991935, 872766.74197191, 872791.29617208,
       872815.1111962 , 872838.65387512, 872862.32389652, 872886.23735175,
       872908.72027165, 872928.86525858, 872947.15206869, 872961.03278531,
       872973.57121833, 872984.76831791, 872994.03670988, 873002.25017301,
       873007.99742385, 873010.93835644, 873010.84327121, 873007.88551665,
       873003.90399997, 873000.17259556, 872996.66809831, 872993.71990768,
       872991.49445612, 872989.98107762, 872988.77532309, 872988.01881009,
       872987.88909408, 872988.1414376 , 872988.96713025, 872990.34444295,
       872992.18313873, 872993.29851063, 872991.27777561, 872989.54064074,
       872987.66122482, 872985.90668206, 872983.41281855, 872978.08310908,
       872971.34047413, 872963.64944792, 872955.19936788, 872946.60276263,
       872937.83306464, 872928.37275333, 872917.51829876, 872905.49025199,
       872892.47219194, 872878.85400854, 872864.36792096, 872849.1187518 ,
       872833.33699719, 872816.8901988 , 872799.78718384, 872782.23267743,
       872764.51631681, 872746.43694548, 872728.05605713, 872710.04206939,
       872692.51062011, 872674.56084613, 872655.88653422, 872636.74271644,
       872617.18336388, 872597.57134874, 872578.39547872, 872559.87635143,
       872542.13338166, 872524.96982202, 872506.98578833, 872487.98411613,
       872468.32395465, 872447.24153627, 872423.80257368, 872399.22814299,
       872373.9022862 , 872348.75911289, 872324.24484767, 872300.82769333,
       872278.94781581, 872258.67845921, 872239.80556321, 872221.53031617,
       872202.92793129, 872184.02767875, 872164.84236701, 872145.80137351,
       872127.53570401, 872110.37405369, 872095.71979345, 872087.72067235,
       872081.56111764, 872076.92366316, 872073.43569108, 872070.93787066,
       872068.67347283, 872065.95772373, 872062.76603866, 872059.91693478,
       872058.15567524, 872057.32913353, 872057.50056811, 872057.29813509])

    AEP_shear = np.array([854888.94973399, 854778.89480857, 854581.15380882, 854316.09062374,
       854036.06479524, 853725.28606694, 853349.94268443, 852865.57284355,
       852395.19328695, 851912.86904061, 851399.69957052, 850898.20688247,
       850420.86195154, 849911.6833759 , 849450.88253376, 849070.57053049,
       848674.51558293, 848283.07998212, 848012.69212723, 847711.48794904,
       847430.21960869, 847082.97299325, 847001.31049596, 847012.38283823,
       847090.10528233, 847244.85068406, 847431.14340073, 847769.20083145,
       848140.68782109, 848438.76205815, 848851.83451354, 849319.14893161,
       849747.59999164, 850162.57272217, 850511.86642602, 850905.76931147,
       851349.18270065, 851788.7141425 , 852265.17321272, 852803.40069222,
       853301.26574391, 853778.22217083, 854229.45147832, 854590.92919966,
       854860.10204862, 855096.58700341, 855268.37512209, 855398.48594627,
       855509.31872894, 855655.83424658, 855825.83649541, 855995.52156137,
       856119.44244557, 856133.21296284, 856097.32583638, 856018.83803755,
       855912.19407639, 855747.24942137, 855488.69886874, 855122.51561453,
       854677.62275674, 854223.56892389, 853758.66987226, 853290.30715028,
       852852.33747313, 852399.13745495, 851961.85634839, 851626.98745425,
       851339.15072598, 851075.58484889, 850945.32342413, 850815.62133733,
       850709.40972502, 850521.73083834, 850589.01076564, 850766.90230088,
       850973.19502593, 851197.44655924, 851467.07515269, 851759.47792288,
       852041.05641809, 852332.74580355, 852690.93070476, 853125.61986729,
       853535.55077112, 853966.51262893, 854390.63455768, 854796.78832539,
       855240.86228047, 855728.00988693, 856233.23156379, 856785.70713623,
       857251.85440289, 857679.1932566 , 858049.2267975 , 858377.82829033,
       858672.02487213, 858937.99109291, 859201.52721204, 859452.11322564,
       859691.17307056, 859937.17663341, 860181.58165972, 860398.77000756,
       860578.45725586, 860664.88647445, 860723.54436814, 860782.84216661,
       860850.55770521, 860927.3502428 , 860987.89424304, 860997.32616908,
       861005.00111052, 861049.91716897, 861122.59793165, 861208.97454119,
       861319.25709503, 861437.48625765, 861569.19234955, 861696.77104065,
       861831.18589704, 862006.01812402, 862201.47735478, 862413.21354389,
       862669.30382332, 862962.36161818, 863292.54071448, 863654.94688815,
       864016.93433504, 864343.25238196, 864658.71748375, 864968.66957804,
       865248.48746063, 865426.50741985, 865587.31551692, 865763.46922106,
       865935.22891644, 866121.72653513, 866327.33414787, 866520.40076342,
       866723.40123003, 866951.31478237, 867198.38310995, 867462.02698339,
       867749.88980014, 868056.63216043, 868331.94013494, 868578.57732908,
       868794.35984688, 869009.63854116, 869235.58601963, 869472.2652324 ,
       869715.56597816, 869961.26951568, 870202.01147335, 870423.34246415,
       870606.44554165, 870759.54528541, 870886.92819751, 870993.27397851,
       871064.95822186, 871092.94375347, 871112.53050792, 871076.9646414 ,
       870993.70417194, 870889.44142771, 870770.36604475, 870651.63002103,
       870546.67261658, 870461.82339418, 870399.63280967, 870361.44484766,
       870347.99187512, 870356.74265115, 870387.20553745, 870433.54689114,
       870489.96462197, 870552.69580333, 870620.27844539, 870688.7411848 ,
       870721.83932268, 870730.88317817, 870734.24745501, 870693.68042676,
       870577.35502438, 870422.86165691, 870268.34309896, 870120.36645501,
       869955.98320694, 869790.40225792, 869635.1332222 , 869499.14863443,
       869384.34036914, 869286.07554406, 869202.94365287, 869129.22424506,
       869069.06439745, 869010.93951501, 868954.9160098 , 868911.32687447])

    AEP_rot = np.array([873768.65782628, 873022.63712664, 871831.95135273, 870431.17843137,
       868988.01638073, 867660.53617707, 866551.0242035 , 865613.10618605,
       865049.66561994, 864645.04391848, 864616.47398717, 865158.01152127,
       866025.25434822, 866919.65691068, 867921.73243242, 868686.80651486,
       869277.49338624, 869774.20984535, 870315.75414203, 870724.66321325,
       871247.05418813, 871790.06642786, 872356.69748383, 872846.16155251,
       873387.87828216, 873940.32094928, 874514.48898196, 874778.24834634,
       874812.55374419, 874771.82779494, 874718.99124647, 874779.97624783,
       874925.1467554 , 875071.0167031 , 875043.90748252, 875149.07680445,
       875362.85280517, 875614.64468255, 876040.86040101, 876286.5488708 ,
       876479.15938349, 876691.83610037, 876876.33364587, 877080.82535391,
       877429.40203639, 877519.98854363, 877557.9413307 , 877577.70930255,
       877537.08728778, 877455.60425047, 877101.82128216, 876612.10702866,
       876207.17897849, 875844.96841554, 875470.4925852 , 875157.04961903,
       874818.21740905, 874524.09794043, 874308.92323699, 874160.62953296,
       873948.99614824, 873514.10406754, 873036.89232558, 872464.37934259,
       871889.58369916, 871491.47261885, 871191.8270639 , 871055.09501075,
       871022.27545525, 871035.52951877, 871123.19414014, 871349.88832856,
       871656.4558848 , 871912.30963228, 872168.04757455, 872451.06830018,
       872721.40181023, 872874.56488708, 873096.24354549, 873360.44080252,
       873709.57580347, 874124.61200049, 874555.50279157, 874963.23567615,
       875303.81482575, 875397.62175743, 875448.81750571, 875366.13974072,
       875165.60341718, 874975.92450562, 874849.34686773, 874691.80254275,
       874456.18629397, 874094.6972375 , 873719.14733913, 873360.42677619,
       873035.94333472, 872732.06877393, 872483.65770601, 872221.23248142,
       871989.24048577, 871786.31394185, 871654.62852308, 871517.33106448,
       871369.84626601, 871231.2092207 , 871067.85103037, 870771.47460618,
       870275.86460185, 869736.44652198, 869196.36995513, 868612.19552362,
       868100.57470104, 867743.51487925, 867496.90304623, 867336.47204352,
       867229.57928444, 867121.85483704, 866950.90124086, 866778.34609668,
       866650.26234568, 866544.22720024, 866521.39505478, 866565.52371536,
       866666.54128241, 866876.60092826, 867255.63432016, 867771.73037102,
       868337.05099458, 868883.23996964, 869471.15386083, 870035.90673243,
       870466.15102137, 870812.02117804, 871125.82800088, 871369.18430337,
       871608.76267218, 871819.50594716, 871951.56216041, 872066.32871301,
       872060.72757633, 871964.52647606, 871889.46410108, 871884.33042602,
       871859.65381422, 871823.87985677, 871703.34513565, 871627.66803207,
       871559.85485894, 871473.29867431, 871347.27377061, 871211.47804765,
       871140.51538845, 871055.22589511, 871018.23772914, 871011.5277911 ,
       871004.74795592, 871089.30089694, 871196.35322109, 871217.99551696,
       871007.07396673, 870730.66331429, 870419.41267022, 870073.2599742 ,
       869652.4074736 , 869218.89966305, 868801.57459156, 868383.42463264,
       868060.38475334, 867872.0604492 , 867733.97077057, 867490.35611035,
       867306.37475263, 867253.91175496, 867222.33007501, 867249.90854458,
       867352.0870523 , 867539.22832809, 867718.91716121, 867867.47150854,
       867942.06023116, 868066.04799961, 868254.39538814, 868394.77821193,
       868509.77244328, 868628.68863598, 868754.29487907, 868978.96027858,
       869187.41385861, 869245.4284808 , 869338.38567111, 869455.09613936,
       869539.77383458, 869509.5612271 , 869322.29139943, 868999.1124424 ,
       868571.67265439, 868092.48949756, 867523.28556836, 866962.18950727])

    AEP_start = np.array([871583.12099784, 871584.51390924, 871585.591814  , 871586.42938119,
       871589.67829701, 871597.57559309, 871604.67511439, 871609.68292216,
       871612.46836832, 871613.36968914, 871615.24669755, 871620.03269488,
       871628.18082231, 871637.30520772, 871645.34121297, 871652.61579629,
       871656.6413847 , 871663.80672652, 871675.86939361, 871693.24933402,
       871715.92439195, 871743.50450564, 871775.19539008, 871810.90787041,
       871850.74734325, 871894.25308196, 871941.10875626, 871992.11003773,
       872047.61216649, 872105.97646929, 872165.90894887, 872226.27710223,
       872287.20517448, 872348.87313434, 872410.41591524, 872471.72709591,
       872531.48328703, 872588.82072434, 872642.2015623 , 872689.55227871,
       872731.00821459, 872768.97410733, 872805.40429618, 872840.76471645,
       872876.42104258, 872910.61741774, 872939.86643207, 872962.19380162,
       872980.41717132, 872994.81270029, 873005.9504577 , 873011.0524993 ,
       873009.43585994, 873003.55798756, 872998.08153797, 872993.48647112,
       872990.55085037, 872988.67633512, 872987.89904795, 872988.18462865,
       872989.72308304, 872992.36978722, 872992.01799857, 872989.37576414,
       872986.60803639, 872982.98895552, 872974.26991684, 872962.91731298,
       872950.12564684, 872937.0331046 , 872922.14579745, 872904.35364294,
       872884.53048048, 872863.02780271, 872839.88174561, 872815.38450243,
       872789.45550882, 872762.91270359, 872735.60990426, 872708.45424908,
       872682.04222278, 872654.18806619, 872625.26771115, 872595.83166046,
       872567.3801928 , 872540.58794016, 872514.54649755, 872486.25350116,
       872456.17258291, 872421.63481321, 872384.36625495, 872346.53235117,
       872310.2633055 , 872277.06551979, 872247.43239285, 872219.8774201 ,
       872191.82144217, 872163.11164403, 872134.91627843, 872108.90297053,
       872090.75474142, 872081.08546923, 872074.74101912, 872070.74140682,
       872067.16725003, 872062.48263419, 872058.76026564, 872057.3058295 ,
       872057.49844256, 872055.24954372, 872046.07516391, 872029.1785628 ,
       872009.63013349, 871991.01885381, 871974.64156046, 871959.55966252,
       871946.17125102, 871934.57379764, 871925.96629582, 871920.58193017,
       871915.16135731, 871909.33927598, 871902.11893558, 871894.06517258,
       871884.05505942, 871871.61165697, 871858.20983671, 871846.94754579,
       871837.5518232 , 871828.14889772, 871819.10671078, 871810.51701821,
       871804.03194265, 871802.7530591 , 871806.59840714, 871813.17209055,
       871821.34924369, 871831.41237858, 871844.26943505, 871858.0982434 ,
       871870.8846817 , 871881.93240425, 871890.53857482, 871899.1508912 ,
       871907.32875113, 871915.03265197, 871922.49977152, 871930.743358  ,
       871940.85892139, 871952.31023952, 871964.00756965, 871973.95009774,
       871979.88753934, 871982.92875477, 871983.86782949, 871980.15816905,
       871971.53070852, 871962.00825723, 871953.48665805, 871944.49859603,
       871934.68690523, 871923.77466274, 871912.87416758, 871901.30106795,
       871891.11621426, 871882.98030141, 871877.03847482, 871869.84697382,
       871866.4604707 , 871866.57652809, 871869.68049314, 871875.84906186,
       871885.12580482, 871894.93391369, 871904.08560383, 871912.8630731 ,
       871921.22100584, 871928.64281312, 871933.93942632, 871936.14529754,
       871934.92492541, 871929.35288091, 871919.562262  , 871906.0511027 ,
       871888.33572931, 871861.90509443, 871824.3603199 , 871781.87880947,
       871740.92202417, 871703.66976682, 871670.39587972, 871641.56983998,
       871617.60130722, 871599.60159022, 871588.29507166, 871583.67182581,
       871583.0681342 , 871584.39781063, 871585.538006  , 871586.34525381])

    import matplotlib as mpl
    mpl.rc('font', family = 'serif', serif = 'cmr10')
    plt.rcParams["mathtext.fontset"] = "dejavuserif"
    fig = plt.figure(figsize=[6.5,4.])
    ax21 = plt.subplot2grid((3, 10), (1, 0),colspan=2)
    ax22 = plt.subplot2grid((3, 10), (1, 2),colspan=2)
    ax23 = plt.subplot2grid((3, 10), (1, 4),colspan=2)
    ax24 = plt.subplot2grid((3, 10), (1, 6),colspan=2)
    ax25 = plt.subplot2grid((3, 10), (1, 8),colspan=2)


    ax21.plot(d_dx,AEP_dx,color='C0',alpha=0.5)
    ax21.set_xticks([2.,3.,4.])
    ax21.set_xticklabels(['2D','3D','4D'])
    ax21.set_xlabel(r'$dx$',fontsize=8)

    ax22.plot(d_dy,AEP_dy,color='C0',alpha=0.5)
    ax22.set_xticks([7.,8.,9.])
    ax22.set_xticklabels(['7D','8D','9D'])
    ax22.set_xlabel(r'$dy$',fontsize=8)

    ax23.plot(d_shear,AEP_shear,color='C0',alpha=0.5)
    ax23.set_xticks([-2.,0.,2.])
    ax23.set_xticklabels(['-2D','0','2D'])
    ax23.set_xlabel(r'$b$',fontsize=8)

    ax24.plot(d_rot,AEP_rot,color='C0',alpha=0.5)
    ax24.set_xticks([-30.,0.,30.])
    ax24.set_xticklabels([r'-30$^\circ$',r'0$^\circ$',r'30$^\circ$'])
    ax24.set_xlabel(r'$\theta$',fontsize=8)

    ax25.plot(d_start,AEP_start,color='C0',alpha=0.5)
    ax25.set_xticks([-1.5,0.,1.5])
    ax25.set_xticklabels(['-1.5D','0','1.5D'])
    ax25.set_xlabel(r'$s$',fontsize=8)

    ax21.set_xlim(2.,4.)
    ax22.set_xlim(7.,9.)
    ax23.set_xlim(-2.,2.)
    ax24.set_xlim(-30.,30.)
    ax25.set_xlim(-1.5,1.5)

    ax21.set_yticks([825000.,850000.,875000.,900000.])
    ax22.set_yticks([825000.,850000.,875000.,900000.])
    ax23.set_yticks([825000.,850000.,875000.,900000.])
    ax24.set_yticks([825000.,850000.,875000.,900000.])
    ax25.set_yticks([825000.,850000.,875000.,900000.])

    ax21.set_yticklabels(['825','850','875','900'])
    ax22.set_yticklabels(['','','',''])
    ax23.set_yticklabels(['','','',''])
    ax24.set_yticklabels(['','','',''])
    ax25.set_yticklabels(['','','',''])

    ax21.set_ylim(825000.,900000.)
    ax22.set_ylim(825000.,900000.)
    ax23.set_ylim(825000.,900000.)
    ax24.set_ylim(825000.,900000.)
    ax25.set_ylim(825000.,900000.)

    ax21.set_ylabel('AEP (GWh)',fontsize=8)

    ax31 = plt.subplot2grid((3, 10), (2, 3),colspan=2)
    ax32 = plt.subplot2grid((3, 10), (2, 5),colspan=2)

    d_x = np.linspace(-2333.419656919867,2333.419656919867,num)
    d_y = np.linspace(-3001.8793994857706,3001.8793994857706,num)

    AEP_x = np.array([835046.93570021, 835034.12179033, 835023.95147924, 834923.7585482 ,
       834755.94087527, 834654.77626259, 834687.20235653, 834835.64790684,
       834804.54073169, 834452.3463334 , 834093.59146961, 833828.56796821,
       833641.62598579, 833424.69601867, 832660.1758774 , 830928.65462942,
       828641.28938967, 826869.30316173, 826603.90269111, 827189.2541967 ,
       829031.26968982, 831141.49560383, 832475.72874029, 832890.03080746,
       833077.09848509, 833278.66557531, 833561.40347443, 833843.60039671,
       834064.36049294, 833803.84550739, 833487.44153365, 833211.85894658,
       833013.53043015, 832871.84194938, 832422.75133916, 830928.6210908 ,
       828752.91275437, 826934.0206137 , 826543.3326616 , 826872.33439781,
       828578.49926344, 830625.88201122, 832214.61129315, 832692.36705441,
       832881.70095764, 833065.57845407, 833319.33585491, 833579.90462644,
       833838.82470884, 833655.33359377, 833344.75641553, 833081.71423875,
       832896.78252953, 832795.00312138, 832451.34732224, 831229.45695749,
       829057.57405628, 827198.57909964, 826550.77149455, 826713.59245326,
       828210.78063942, 830214.91363155, 831989.67439108, 832600.29974309,
       832806.53388118, 832962.28773359, 833203.76391472, 833471.9833459 ,
       833764.28933333, 833667.06217356, 833372.84185624, 833106.28713377,
       832919.13172736, 832829.41732475, 832595.87851978, 831574.38546083,
       829490.82561818, 827497.61631804, 826621.27787608, 826699.89576916,
       827932.7356751 , 829910.17658842, 831820.94978816, 832622.68575315,
       832854.08524242, 833042.46005544, 833290.4433309 , 833587.63426004,
       833920.33031561, 833965.63338405, 833760.87555386, 833578.91939745,
       833515.07181733, 833624.95393639, 833848.74877774, 833726.04556499,
       833599.23186133, 833530.71635281, 833479.72130796, 833470.33783972,
       833592.79235726, 833673.99097768, 833736.96917887, 833754.74313798,
       833636.12347897, 833578.34793662, 833627.87162924, 833759.20555828,
       833974.19042915, 834014.35229297, 833691.7882362 , 833360.75511346,
       833089.84132711, 832936.03962289, 832783.69814852, 832081.9388962 ,
       830312.06994137, 828163.06287438, 826664.67311831, 826543.99885727,
       827230.61601532, 829098.68382814, 831151.27562229, 832349.84349043,
       832685.06908256, 832855.01502157, 833019.66467852, 833270.07760876,
       833553.90559105, 833752.15837741, 833497.9444379 , 833225.05564036,
       832997.75406761, 832879.16344111, 832795.08435621, 832245.38431569,
       830728.85012704, 828589.63091338, 826831.15123498, 826588.96011149,
       827043.51484769, 828769.46804626, 830819.84707772, 832290.03869696,
       832725.67866405, 832890.03069576, 833038.90009387, 833292.2216207 ,
       833576.3811969 , 833855.04881654, 833645.01368667, 833374.18595583,
       833135.97977338, 832993.58710521, 832907.79514484, 832490.753733  ,
       831236.16306858, 829054.70084695, 827253.25696941, 826706.35468525,
       826944.64222238, 828615.24957266, 830667.41880647, 832360.38255661,
       832951.49914136, 833133.23598871, 833255.58180236, 833482.69265145,
       833754.93723221, 834066.21185692, 833920.2842682 , 833659.04517589,
       833408.2304877 , 833243.31159936, 833151.27475924, 832865.23822847,
       831817.91632187, 829684.01855569, 827763.91803856, 827000.00241024,
       827157.91476053, 828585.00788877, 830685.37371872, 832618.37782054,
       833432.33147734, 833658.37525113, 833844.91177293, 834151.02648685,
       834520.9702012 , 834955.64151342, 835017.56591524, 834853.26451657,
       834721.73102784, 834707.35167854, 834845.13113734, 835078.83527136,
       834986.17412898, 834916.36381922, 834969.90271865, 835154.79564433])

    AEP_y = np.array([834445.40103313, 834241.19010449, 834026.47904582, 833759.93225976,
       833302.1915122 , 832871.31168452, 832587.02098724, 832500.56094421,
       832604.06068281, 832867.50304557, 833100.3932885 , 833259.25460521,
       833389.88915029, 833344.75165318, 833308.94242001, 833229.05599223,
       833063.10587822, 832903.43672873, 832673.17877426, 832530.79622176,
       832454.51078494, 832401.98437793, 832665.26883361, 832896.41352652,
       833049.2334414 , 833173.82416769, 833312.44687925, 833517.62167408,
       833605.2474247 , 833657.08077988, 833747.98626004, 833763.24986235,
       833828.17404195, 833913.76670456, 833910.42056542, 833851.5353783 ,
       833776.53827919, 833703.22433647, 833691.39041207, 833626.35617352,
       833527.18443696, 833481.78786382, 833356.35418791, 833203.19858851,
       833123.76891819, 832950.1342973 , 832731.30940418, 832449.32796225,
       832086.76762299, 831594.69186117, 830855.35440782, 829546.6280075 ,
       828671.75049599, 828585.90606981, 829499.28836127, 830507.41002165,
       831331.07624175, 831936.36457003, 832238.57620345, 832488.61499076,
       832691.14277429, 832809.93823704, 832827.60429188, 832777.46457828,
       832706.96741574, 832627.6011794 , 832629.55359582, 832713.57620871,
       832884.53245528, 833124.80131512, 833242.4054585 , 833284.50996165,
       833323.71917281, 833360.18276835, 833395.61184368, 833442.5800949 ,
       833418.71289052, 833421.99724239, 833487.76805565, 833565.98064666,
       833642.11457885, 833701.24997366, 833719.57142964, 833616.35535071,
       833481.5930475 , 833431.86919523, 833408.78759096, 833451.75729365,
       833589.99875247, 833691.65183542, 833713.61404177, 833764.61788891,
       833807.10772297, 833853.55860453, 833892.34336669, 833864.87972931,
       833814.26270869, 833680.55493317, 833563.514587  , 833470.75673457,
       833472.28056942, 833566.54225991, 833663.65620541, 833741.76628097,
       833754.8031397 , 833779.68554646, 833803.46239768, 833868.01675233,
       833923.99217372, 833939.44542339, 833948.53638958, 833841.19595277,
       833670.03087679, 833589.52141152, 833502.57599138, 833510.38090058,
       833636.30694803, 833678.75581581, 833605.99422273, 833553.17778916,
       833426.71292276, 833388.78433407, 833372.01541982, 833407.79320952,
       833438.81027885, 833414.02730893, 833386.1981717 , 833399.75770176,
       833400.41635335, 833341.33663138, 833132.48640146, 832918.17618125,
       832738.04084451, 832632.43266444, 832583.96831796, 832657.5448602 ,
       832710.55510498, 832738.40624782, 832719.80581889, 832625.62259631,
       832540.18262334, 832293.11153944, 831990.79982107, 831407.86389176,
       830480.49079945, 829339.95955732, 828529.34130521, 828667.57388457,
       829490.20657267, 830756.29779947, 831519.76227565, 832067.92225055,
       832495.46831317, 832835.51726703, 833082.67875037, 833256.7535687 ,
       833422.67689653, 833633.47270958, 833819.91602567, 833949.97091202,
       834010.52453313, 834002.51399057, 833979.1007088 , 834032.50848009,
       834011.08377693, 834010.25293321, 833972.75617685, 833921.39193577,
       833886.33834206, 833838.26459848, 833775.08183231, 833805.01694919,
       833786.87094535, 833622.63044496, 833477.07213787, 833341.37473006,
       833186.74751983, 832807.86356164, 832644.56910379, 832656.13609923,
       832835.0784661 , 833034.18398107, 833374.85718819, 833671.39947581,
       833889.6980552 , 834109.03708445, 834350.18254657, 834587.61755088,
       834707.12810903, 834782.88203969, 834821.51382438, 834891.41434737,
       835023.58907909, 835138.0722293 , 835205.99217194, 835280.88575041,
       835358.34578171, 835432.48139145, 835484.7544569 , 835584.98976928])

    #
    ax31.plot(d_x,AEP_x,color='C3',alpha=0.5)
    # ax1.set_xticks([2.,3.,4.])
    # ax1.set_xticklabels(['2','3','4'])
    # ax1.set_xlabel(r'$dx$ '+'(rotor\ndiameters)')

    ax32.plot(d_y,AEP_y,color='C3',alpha=0.5)
    # ax2.set_xticks([7.,8.,9.])
    # ax2.set_xticklabels(['7','8','9'])
    # ax2.set_xlabel(r'$dy$ '+'(rotor\ndiameters)')
    #
    # ax1.set_xlim(2.,4.)
    # ax2.set_xlim(7.,9.)

    ax31.set_yticks([825000.,829000.,833000.,837000.])
    ax32.set_yticks([825000.,829000.,833000.,837000.])


    ax31.set_yticklabels(['825','829','833','837'])
    ax32.set_yticklabels(['','','',''])

    ax31.set_ylim(825000.,837000.)
    ax32.set_ylim(825000.,837000.)

    ax31.set_xlim(min(d_x),max(d_x))
    ax32.set_xlim(min(d_y),max(d_y))

    ax31.set_xticks((-2000.,0.,2000.))
    ax32.set_xticks((-2500.,0.,2500.))

    ax31.set_xticklabels(['-2000','0','2000'])
    ax32.set_xticklabels(['-2500','0','2500'])

    ax31.set_ylabel('AEP (GWh)',fontsize=8)

    ax11 = plt.subplot2grid((3, 10), (0, 1),colspan=2)
    ax12 = plt.subplot2grid((3, 10), (0, 3),colspan=2)
    ax13 = plt.subplot2grid((3, 10), (0, 5),colspan=2)
    ax14 = plt.subplot2grid((3, 10), (0, 7),colspan=2)

    d_dx = np.linspace(2.,4.,num)
    d_dy = np.linspace(2.,4.,num)
    d_shear = np.linspace(-2.,2.,num)
    d_rot = np.linspace(-30.,30.,num)

    AEP_dx = np.array([758571.3925761 , 759372.10573822, 760088.16732161, 760730.99624786,
           761317.54518145, 761843.8579298 , 762309.47377813, 762718.66548757,
           763075.87814329, 763382.25940078, 763640.7468331 , 763856.88353666,
           764035.47678197, 764181.22906932, 764297.6851575 , 764389.38101883,
           764461.2356392 , 764518.18219062, 764563.70094388, 764601.10281197,
           764633.3674478 , 764663.47638735, 764695.50840206, 764732.92793811,
           764777.65100966, 764831.39157733, 764896.00788439, 764974.24032095,
           765068.97210194, 765181.23234166, 765308.40604053, 765452.9967108 ,
           765616.26605424, 765795.30333841, 765984.99253261, 766190.77099916,
           766418.23710763, 766669.14222595, 766944.49539416, 767246.52991211,
           767577.35920254, 767939.02711944, 768333.84996461, 768765.04234321,
           769237.4168748 , 769753.23635545, 770314.01038069, 770920.12765146,
           771571.56184228, 772267.87862689, 773008.41585255, 773792.66937365,
           774620.04324629, 775489.95247538, 776401.75238255, 777354.45768818,
           778347.15820033, 779378.85918476, 780448.36192623, 781554.59685428,
           782696.41430879, 783872.50090445, 785081.67222754, 786322.71322285,
           787594.35636051, 788895.33466086, 790224.34324109, 791580.02749336,
           792961.0750319 , 794366.10402616, 795793.57207333, 797241.86890709,
           798709.3121687 , 800193.80398444, 801681.03496405, 803159.08884433,
           804622.93859255, 806061.47592962, 807444.0103751 , 808763.72104362,
           810016.88321802, 811203.56298454, 812346.89635152, 813443.19483319,
           814482.6770299 , 815448.74698822, 816343.54775614, 817173.05558846,
           817944.69819308, 818673.06399443, 819370.47021726, 820047.87047238,
           820710.97661648, 821361.7746969 , 821998.89238913, 822619.69000483,
           823222.49248808, 823805.77532558, 824366.71078854, 824902.87146902,
           825409.51081268, 825884.81478832, 826328.33582082, 826722.92777   ,
           827058.91010457, 827336.69662241, 827558.7893403 , 827730.38432472,
           827871.49766246, 827987.69553828, 828079.92338031, 828149.5151447 ,
           828199.19793051, 828235.23806995, 828259.30430408, 828271.99406416,
           828274.08613788, 828266.90022418, 828251.4224739 , 828228.30839484,
           828198.03476405, 828161.42065027, 828119.39796599, 828072.90287891,
           828022.48271932, 827969.0533218 , 827913.67147856, 827857.080951  ,
           827800.2229523 , 827743.79052862, 827688.93006523, 827637.1317384 ,
           827589.66589025, 827547.77634116, 827512.75494682, 827485.73345763,
           827467.86115884, 827460.26935666, 827464.21865005, 827480.7589441 ,
           827510.86140965, 827555.38865605, 827615.19198115, 827691.38173094,
           827784.99405357, 827896.63534958, 828026.83051136, 828176.03705997,
           828344.67782593, 828532.96282955, 828741.1399415 , 828969.507329  ,
           829218.29646312, 829487.67835633, 829777.76845474, 830088.62662112,
           830420.25707558, 830772.60820639, 831145.57235849, 831538.98776296,
           831952.638475  , 832386.25659889, 832839.52209701, 833312.06424987,
           833803.46355383, 834313.25391748, 834840.92513487, 835385.92560853,
           835947.66344592, 836525.49275198, 837118.72748698, 837726.66207661,
           838348.56288639, 838983.66830919, 839631.14959241, 840290.16389512,
           840959.9537792 , 841639.77797826, 842328.89328863, 843026.57919814,
           843732.13517521, 844444.8496525 , 845163.98208441, 845888.80014092,
           846618.59900835, 847352.69452271, 848090.42812002, 848831.1766485 ,
           849574.32470528, 850319.27465124, 851065.45705934, 851812.21581137,
           852554.39928813, 853288.89177138, 854014.94693326, 854731.86239126,
           855438.97960279, 856132.7296434 , 856801.34336775, 857426.29177933])

    AEP_dy = np.array([736020.81802209, 737046.49890055, 738086.73287083, 739140.08369086,
           740205.22450226, 741281.75010871, 742370.09628149, 743468.97421599,
           744578.01678061, 745697.75678834, 746828.34497151, 747970.09814933,
           749122.5711138 , 750285.21599537, 751459.81849691, 752647.79248249,
           753849.53318381, 755065.50582137, 756295.3616589 , 757538.84127884,
           758796.54195638, 760068.4147818 , 761355.03932556, 762657.10309369,
           763974.5619423 , 765306.35299026, 766651.63908462, 768009.69096114,
           769380.10799101, 770762.93910077, 772157.53885125, 773563.26391135,
           774977.65954018, 776393.24105019, 777807.46602013, 779217.55381378,
           780620.9888032 , 782010.5206962 , 783382.87608976, 784734.79389936,
           786064.08077907, 787367.07737475, 788645.78004949, 789905.78097738,
           791158.28979886, 792403.15727387, 793638.2806534 , 794860.01772233,
           796067.33581719, 797261.28817294, 798443.78048233, 799614.41446759,
           800769.86241415, 801909.60468707, 803034.33584273, 804145.40488384,
           805243.81401916, 806329.53508896, 807401.70885862, 808460.23758928,
           809505.01814816, 810535.92750415, 811553.79887588, 812560.75688061,
           813556.87742022, 814542.01829087, 815516.85153124, 816482.21795321,
           817438.79572647, 818387.28487242, 819327.83354487, 820258.38322252,
           821175.50583383, 822078.79381148, 822967.17957331, 823831.91838903,
           824665.99644879, 825471.99372086, 826248.15604501, 826996.92095305,
           827725.47831479, 828436.67587151, 829129.57245922, 829801.86259268,
           830453.65584904, 831085.48813892, 831697.78929187, 832291.92393442,
           832868.92068766, 833431.21966931, 833980.58112166, 834518.08408569,
           835044.29195742, 835559.69805445, 836060.59945886, 836541.42775257,
           837001.67927283, 837440.94992058, 837857.44891613, 838244.5392461 ,
           838598.05296147, 838918.91476905, 839205.92824192, 839444.53247451,
           839631.08970574, 839763.99064254, 839847.85335715, 839880.52228107,
           839868.30876014, 839826.44836434, 839758.05141546, 839660.21019358,
           839536.40840915, 839390.59590821, 839226.84558772, 839049.54464844,
           838861.69127884, 838665.52181191, 838465.445822  , 838264.81991419,
           838064.510622  , 837865.77507992, 837669.54405313, 837475.9486646 ,
           837284.71895719, 837095.63517498, 836909.48837944, 836726.21397415,
           836545.82805883, 836368.11658232, 836192.87534276, 836019.85056742,
           835849.14287372, 835681.16744974, 835516.31155625, 835354.71809314,
           835196.46177514, 835041.94202476, 834891.66648263, 834746.05656812,
           834605.74125274, 834471.21981831, 834343.08099596, 834221.74621091,
           834107.41743429, 834000.26337344, 833900.44602628, 833808.08675846,
           833723.26785839, 833646.10772363, 833576.72327521, 833515.2303247 ,
           833461.73397367, 833416.37414791, 833379.33671631, 833350.76760131,
           833330.78177715, 833319.49088558, 833316.99238238, 833323.3848873 ,
           833338.75835078, 833363.17520626, 833396.68140806, 833439.31272499,
           833491.09495108, 833552.04316412, 833622.16326545, 833701.45292103,
           833789.8961977 , 833887.4646539 , 833994.12065545, 834110.33743263,
           834236.54380952, 834372.77349119, 834519.03297197, 834674.15937295,
           834837.2068258 , 835008.01114686, 835186.34366346, 835370.87764263,
           835560.23257712, 835752.95029975, 835947.36632917, 836142.3237844 ,
           836337.5209641 , 836534.68186357, 836734.29087386, 836936.65199159,
           837143.070662  , 837354.98660062, 837573.54462443, 837800.02881967,
           838034.92038703, 838278.16213811, 838529.49580292, 838788.81734955,
           839056.04541737, 839331.09199858, 839613.86263551, 839904.25964808])

    AEP_shear = np.array([866614.20791648, 867083.31508584, 867607.69679304, 868174.5506042 ,
           868601.40038776, 868773.82551025, 868756.76134137, 868727.47085432,
           868717.75331526, 868799.30319957, 868989.36476399, 869261.96533619,
           869562.3894521 , 869859.71339524, 870052.31316873, 870086.29322821,
           869955.49152229, 869737.3174354 , 869484.33457198, 869244.15713215,
           869001.35575567, 868751.57519814, 868511.21821923, 868282.47302541,
           868059.43200178, 867789.01691814, 867347.57330904, 866408.08985545,
           864950.01798671, 863317.55039412, 861631.29974855, 859961.17577074,
           858334.18936351, 856767.12936921, 855275.54700604, 853872.90161019,
           852569.97332648, 851375.17813766, 850293.33416896, 849317.41240315,
           848421.35470454, 847603.88139134, 846883.03053211, 846284.02963094,
           845814.556511  , 845479.30926029, 845289.00632737, 845252.59062152,
           845363.82200523, 845587.65938075, 845920.56242634, 846317.4832543 ,
           846656.72148124, 846903.85600497, 847194.98724136, 847631.48093562,
           848227.61083406, 848976.13104177, 849865.59650795, 850883.81380879,
           852014.63928463, 853236.09018763, 854519.11029063, 855838.0787497 ,
           857187.53395122, 858564.21445779, 859962.86859457, 861375.70208355,
           862793.87989206, 864200.1680851 , 865529.7474374 , 866679.7033053 ,
           867348.08121422, 867494.20366501, 867364.76381785, 867106.25967859,
           866761.76602596, 866178.42457937, 864874.14101795, 862750.42856122,
           860361.4681185 , 857897.44264418, 855445.70367739, 853023.66901962,
           850641.04859266, 848299.44593573, 846013.35647149, 843806.53766511,
           841705.58859056, 839721.78945297, 837854.47957625, 836114.37795172,
           834529.4575602 , 833121.63706559, 831903.05032179, 830880.8924476 ,
           830058.12035995, 829432.93594366, 829004.13829758, 828774.47391829,
           828745.37853624, 828914.56421701, 829274.17439011, 829809.1310179 ,
           830522.93565998, 831426.51584773, 832517.9297852 , 833790.42652673,
           835236.80657923, 836848.25236749, 838614.17023679, 840522.22508061,
           842556.81865843, 844694.93628412, 846903.47181903, 849151.24072424,
           851410.29896538, 853672.7354191 , 855930.18636588, 858170.45652632,
           860316.76632907, 862209.69741001, 863388.45147206, 863859.46353613,
           864010.04694957, 864032.35381979, 863935.75414871, 863557.8198174 ,
           862476.9856212 , 860672.03863586, 858611.79608039, 856447.21673484,
           854258.41483717, 852064.1569366 , 849874.15378958, 847699.10159217,
           845540.21994986, 843400.42079447, 841315.1528563 , 839327.73059401,
           837477.91000247, 835789.5137938 , 834268.47211587, 832908.90075439,
           831704.93922925, 830631.70589502, 829645.90758107, 828661.31255484,
           827639.30254848, 826654.56913448, 825794.76262363, 825088.16975071,
           824540.2293204 , 824169.64935152, 823974.78686248, 823934.72379926,
           824048.31453   , 824333.99897519, 824797.6255898 , 825438.57170204,
           826253.87240821, 827238.63340921, 828387.0265534 , 829691.68151625,
           831143.26846214, 832730.09241152, 834438.12466096, 836251.29475062,
           838152.00329615, 840121.82333294, 842129.43767492, 844087.72200397,
           845868.13256698, 847113.01726278, 847775.27794732, 848172.03989302,
           848480.84121342, 848803.66286792, 849146.23494219, 849511.44139605,
           849902.68300399, 850325.61919522, 850783.84285338, 851235.98349272,
           851626.7925979 , 851818.66766951, 851728.90078917, 851453.79275458,
           851182.63660523, 850984.36652604, 850936.92856183, 851070.69020007,
           851360.88201646, 851729.89790467, 852109.38525478, 852331.39265405,
           852289.25805578, 852052.42968445, 851762.40756602, 851464.4437076 ])

    AEP_rot = np.array([838515.74534606, 840540.47973276, 842665.39775764, 844881.58248964,
           847169.77225837, 849490.39842834, 851731.53530875, 853933.82367575,
           856145.36089982, 858366.7610357 , 860363.54816002, 861802.54772357,
           862841.81223273, 863734.26731151, 864573.00923015, 865292.53551165,
           865860.27234124, 866340.89871928, 866750.48896302, 867098.8312258 ,
           867429.94922581, 867785.81341382, 868195.27497049, 868668.48389518,
           869142.07618188, 869422.37120325, 869168.80503178, 868357.70133152,
           867307.0176534 , 866157.22701589, 864954.26818819, 863690.5614184 ,
           862231.00653949, 860580.85649476, 858888.91262567, 857200.82152759,
           855504.77719346, 853794.62030658, 852036.81118587, 850239.84158866,
           848418.89648681, 846415.62807951, 844201.90052325, 842022.99715444,
           840017.21173995, 838247.5842605 , 836741.46897901, 835510.38164783,
           834561.47881698, 833897.15962989, 833515.64635747, 833417.35889849,
           833573.00744677, 833930.8948609 , 834445.31773577, 835126.11886526,
           835980.18736796, 836985.77564353, 838083.4734594 , 839299.13823637,
           840635.51825252, 842076.21755323, 843407.71734792, 844389.60863703,
           845183.28787712, 845984.95939623, 846877.69589363, 847829.71777412,
           848824.57690897, 849875.36867476, 850958.40758453, 852074.90549183,
           853263.23750307, 854558.29726489, 855981.64566338, 857534.21530306,
           859151.17316378, 860677.24330454, 861854.28844937, 862677.2432988 ,
           863355.21376761, 863965.67671855, 864491.9959609 , 864796.37809657,
           864532.89792238, 863772.74885875, 862829.36342961, 861810.16653338,
           860704.53485582, 859482.18505201, 858051.67446146, 856397.24802014,
           854504.85029536, 852082.88520026, 849120.25066455, 846013.0730422 ,
           842943.85810395, 840008.65066007, 837242.81515848, 834665.72112031,
           832294.73499783, 830144.73496466, 828229.32061359, 826565.54364729,
           825138.54720254, 823908.60135775, 822850.03205043, 822000.38986602,
           821400.28911455, 821056.79040034, 820959.10163121, 821129.64427017,
           821553.13945478, 822186.69875858, 822850.07053322, 823413.29706024,
           824035.55079465, 824859.39638467, 825935.47443579, 827242.72822309,
           828771.0203439 , 830517.44556574, 832453.93236591, 834576.98124301,
           836909.5919445 , 839468.61866111, 842259.12407854, 845267.38936353,
           848435.05780439, 851657.24974102, 854757.88176985, 857695.80360148,
           860547.59223136, 863346.98358641, 866036.59039002, 868332.08047109,
           869702.87676486, 870321.34798081, 870645.51671431, 870858.06101198,
           870968.84814116, 870936.73948829, 870670.2839728 , 870123.15326621,
           869219.25033325, 867631.89731735, 865382.30193105, 862868.12690106,
           860238.94240722, 857586.55151572, 854940.88102373, 852323.19100396,
           849755.78292411, 847261.33747121, 844863.50019132, 842587.81829321,
           840442.21961503, 838421.33659865, 836532.55172129, 834807.47415653,
           833277.61661319, 831962.27759206, 830877.86654401, 830061.34300752,
           829498.05672195, 829081.58168272, 828647.82950267, 828213.54989055,
           827964.16479669, 828023.08350089, 828408.03245143, 829114.39345928,
           830147.09574645, 831512.52219164, 833197.15340071, 835198.66666996,
           837527.63496443, 840185.39588221, 843161.49773622, 846428.27865123,
           849928.80165496, 853580.16334811, 857198.1448885 , 860645.72495751,
           863914.4999426 , 867077.66745917, 870144.79760283, 872800.60627493,
           874578.08348891, 875706.16740794, 876575.2991063 , 877347.94832104,
           878017.83195756, 878513.05872416, 878707.84451544, 878561.54617675,
           878028.71963642, 876849.645879  , 875073.38132547, 873010.00430608])

    ax11.plot(d_dx,AEP_dx,color='C1',alpha=0.5)
    ax11.set_xticks([2.,3.,4.])
    ax11.set_xticklabels(['2D','3D','4D'])
    ax11.set_xlabel(r'$dx$',fontsize=8)

    ax12.plot(d_dy,AEP_dy,color='C1',alpha=0.5)
    ax12.set_xticks([2.,3.,4.])
    ax12.set_xticklabels(['2D','3D','4D'])
    ax12.set_xlabel(r'$dy$',fontsize=8)

    ax13.plot(d_shear,AEP_shear,color='C1',alpha=0.5)
    ax13.set_xticks([-2.,0.,2.])
    ax13.set_xticklabels(['-2D','0','2D'])
    ax13.set_xlabel(r'$b$',fontsize=8)

    ax14.plot(d_rot,AEP_rot,color='C1',alpha=0.5)
    ax14.set_xticks([-30.,0.,30.])
    ax14.set_xticklabels([r'-30$^\circ$',r'0$^\circ$',r'30$^\circ$'])
    ax14.set_xlabel(r'$\theta$',fontsize=8)

    ax11.set_xlim(2.,4.)
    ax12.set_xlim(2.,4.)
    ax13.set_xlim(-2.,2.)
    ax14.set_xlim(-30.,30.)

    ax11.set_yticks([725000.,775000.,825000.,875000.])
    ax12.set_yticks([725000.,775000.,825000.,875000.])
    ax13.set_yticks([725000.,775000.,825000.,875000.])
    ax14.set_yticks([725000.,775000.,825000.,875000.])

    ax11.set_yticklabels(['725','775','825','875'])
    ax12.set_yticklabels(['','','',''])
    ax13.set_yticklabels(['','','',''])
    ax14.set_yticklabels(['','','',''])

    ax11.set_ylim(725000.,875000.)
    ax12.set_ylim(725000.,875000.)
    ax13.set_ylim(725000.,875000.)
    ax14.set_ylim(725000.,875000.)

    ax11.set_ylabel('AEP (GWh)',fontsize=8)

    ax31.set_xlabel(r'$x_{50}$',fontsize=8)
    ax32.set_xlabel(r'$y_{50}$',fontsize=8)


    ax11.tick_params(axis='both', which='major', labelsize=8)
    ax11.tick_params(axis='both', which='minor', labelsize=8)
    ax12.tick_params(axis='both', which='major', labelsize=8)
    ax12.tick_params(axis='both', which='minor', labelsize=8)
    ax13.tick_params(axis='both', which='major', labelsize=8)
    ax13.tick_params(axis='both', which='minor', labelsize=8)
    ax14.tick_params(axis='both', which='major', labelsize=8)
    ax14.tick_params(axis='both', which='minor', labelsize=8)

    ax21.tick_params(axis='both', which='major', labelsize=8)
    ax21.tick_params(axis='both', which='minor', labelsize=8)
    ax22.tick_params(axis='both', which='major', labelsize=8)
    ax22.tick_params(axis='both', which='minor', labelsize=8)
    ax23.tick_params(axis='both', which='major', labelsize=8)
    ax23.tick_params(axis='both', which='minor', labelsize=8)
    ax24.tick_params(axis='both', which='major', labelsize=8)
    ax24.tick_params(axis='both', which='minor', labelsize=8)
    ax25.tick_params(axis='both', which='major', labelsize=8)
    ax25.tick_params(axis='both', which='minor', labelsize=8)

    ax31.tick_params(axis='both', which='major', labelsize=8)
    ax31.tick_params(axis='both', which='minor', labelsize=8)
    ax32.tick_params(axis='both', which='major', labelsize=8)
    ax32.tick_params(axis='both', which='minor', labelsize=8)

    loc = 0.1
    ax11.text(0.8,875000.-loc*150000.,'a',fontsize=11,color='black')
    ax21.text(0.8,900000.-loc*75000.,'b',fontsize=11,color='black')
    ax31.text(min(d_x)-1.2*max(d_x),837000.-loc*12000.,'c',fontsize=11,color='black')

    plt.subplots_adjust(top = 0.93, bottom = 0.1, right = 0.96, left = 0.1,
            hspace = 0.7, wspace = 1.0)

    plt.savefig('/Users/ningrsrch/Dropbox/Projects/reduction/paper/paper-figures/multimodality.pdf',transparent=True)
    plt.show()
