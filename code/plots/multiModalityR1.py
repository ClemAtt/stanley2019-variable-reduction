import numpy as np
import scipy as sp
import sys
import matplotlib.pyplot as plt
sys.dont_write_bytecode = True


if __name__ == "__main__":

    nTurbines = 100

    num = 200
    d_dx = np.linspace(2.,3.,num)
    d_dy = np.linspace(8.,10.,num)
    d_shear = np.linspace(2.,4.,num)
    d_rot = np.linspace(-10.,10.,num)
    d_start = np.linspace(-2,2,num)

    AEP_dx = np.array([1365869.34295398,  1366080.06739614,  1366287.61447064,
        1366492.76272339,  1366701.59814303,  1366910.77902102,
        1367120.04172719,  1367328.49137441,  1367536.15363293,
        1367745.00382154,  1367953.99758509,  1368164.30236347,
        1368371.90763994,  1368577.64001879,  1368781.39674107,
        1368984.04991362,  1369183.53541418,  1369380.4793678 ,
        1369575.21237656,  1369769.56589173,  1369962.17785702,
        1370155.0631664 ,  1370347.16846488,  1370542.76470451,
        1370735.50052685,  1370923.82821549,  1371109.7979397 ,
        1371296.04537385,  1371481.18964356,  1371663.84736328,
        1371841.43159635,  1372013.60094946,  1372182.12170136,
        1372348.46330193,  1372511.48675879,  1372670.5713426 ,
        1372826.97666319,  1372984.53844126,  1373138.88734814,
        1373289.99041875,  1373437.67542877,  1373584.53729449,
        1373733.68245108,  1373883.06733339,  1374031.29727446,
        1374179.96553952,  1374329.26112036,  1374478.86524866,
        1374626.99099308,  1374776.39177778,  1374923.94530125,
        1375070.55104244,  1375216.86017668,  1375365.23147439,
        1375516.82915697,  1375673.76528889,  1375832.50711331,
        1375991.13595102,  1376149.95055537,  1376311.16729369,
        1376473.82951124,  1376637.39442855,  1376802.57666576,
        1376970.2802101 ,  1377141.56156967,  1377313.63464714,
        1377488.26209934,  1377664.40802811,  1377838.72383678,
        1378014.57562113,  1378191.00739084,  1378375.68197234,
        1378561.52115432,  1378745.68376676,  1378929.97275352,
        1379112.12305377,  1379290.1264255 ,  1379466.18625147,
        1379639.24459489,  1379807.77397858,  1379971.44124188,
        1380129.63538443,  1380281.47111476,  1380426.77813134,
        1380565.1834122 ,  1380698.4532444 ,  1380827.70351281,
        1380951.2620532 ,  1381065.801706  ,  1381173.32233038,
        1381273.85879395,  1381373.00491952,  1381471.16293102,
        1381563.78549068,  1381651.30733761,  1381732.00279881,
        1381806.68583179,  1381878.14469158,  1381942.35381963,
        1381999.32614642,  1382049.79213198,  1382093.74778606,
        1382129.66797316,  1382159.52257276,  1382181.64344774,
        1382198.93113182,  1382211.38521086,  1382221.35871978,
        1382232.22949156,  1382246.17228916,  1382256.94618345,
        1382264.11869495,  1382266.84927923,  1382265.35508457,
        1382261.10719169,  1382254.45788874,  1382246.80838953,
        1382239.58153309,  1382237.63610794,  1382244.61184865,
        1382253.721746  ,  1382265.6726112 ,  1382279.95236971,
        1382296.28732472,  1382314.48487435,  1382333.823723  ,
        1382354.33170969,  1382376.19001692,  1382399.43272514,
        1382426.44857143,  1382456.20733276,  1382485.1911674 ,
        1382513.07469562,  1382538.63755606,  1382562.28230141,
        1382585.70258923,  1382605.882841  ,  1382625.21759164,
        1382641.45667548,  1382653.70326389,  1382663.35193243,
        1382668.62457853,  1382666.73313242,  1382659.0421128 ,
        1382646.67691439,  1382627.26178386,  1382599.58070802,
        1382565.67249152,  1382525.94198833,  1382480.19419363,
        1382434.42791034,  1382388.50769965,  1382339.0409462 ,
        1382285.88321734,  1382228.15429451,  1382167.68251627,
        1382100.68645642,  1382028.43014948,  1381950.38686321,
        1381867.04853563,  1381780.16359314,  1381688.68020763,
        1381592.12719032,  1381492.71277593,  1381393.84698415,
        1381295.72583577,  1381201.3425966 ,  1381101.3810574 ,
        1380995.12967645,  1380882.20254321,  1380765.89885477,
        1380645.38048621,  1380521.35035157,  1380398.43574159,
        1380269.52652346,  1380133.20250754,  1379989.81438156,
        1379837.29453516,  1379678.91261503,  1379513.83322803,
        1379343.92575732,  1379167.1226767 ,  1378984.41192744,
        1378793.79753542,  1378594.76799783,  1378384.32741668,
        1378163.41915324,  1377936.85560314,  1377709.33418518,
        1377481.12648233,  1377247.73516619,  1377017.73010497,
        1376782.10805264,  1376541.58343903,  1376300.88800872,
        1376051.8793031 ,  1375803.57915008,  1375574.11613011,
        1375711.02475498,  1375164.96635902])

    AEP_dy = np.array([1377155.22718947,  1377244.23596889,  1377332.82191244,
        1377421.34872959,  1377509.92630941,  1377597.78970394,
        1377684.56247085,  1377770.03087281,  1377853.6447528 ,
        1377935.23989045,  1378015.56399992,  1378095.54089307,
        1378173.25727948,  1378248.67284573,  1378322.06274657,
        1378393.32887259,  1378462.65034332,  1378530.03911095,
        1378595.50053859,  1378658.78621934,  1378719.83844713,
        1378778.78953004,  1378835.82806144,  1378890.36712054,
        1378942.87047987,  1378994.0795069 ,  1379044.24726253,
        1379093.41403923,  1379141.23241585,  1379187.47703415,
        1379232.6097038 ,  1379277.06396067,  1379321.7747803 ,
        1379365.76718325,  1379415.21858046,  1379465.21603382,
        1379514.28502675,  1379562.47100466,  1379610.75692653,
        1379658.57550433,  1379705.9224215 ,  1379752.33880068,
        1379797.49566848,  1379842.31968298,  1379886.54018268,
        1379930.15124728,  1379972.83078791,  1380014.72081447,
        1380055.54208158,  1380094.42793891,  1380132.16666558,
        1380168.82858667,  1380204.5046331 ,  1380239.40779836,
        1380274.81931637,  1380310.1669418 ,  1380344.71743606,
        1380378.80411807,  1380413.06839627,  1380448.22640086,
        1380484.2017883 ,  1380519.91742761,  1380555.7888882 ,
        1380591.54464444,  1380627.22452566,  1380662.73265007,
        1380698.30096443,  1380733.73510918,  1380769.01432501,
        1380803.95079656,  1380838.63248454,  1380873.11559789,
        1380907.65598487,  1380941.97106226,  1380976.74539926,
        1381011.43409457,  1381046.91444877,  1381082.03310852,
        1381116.8472863 ,  1381151.45904546,  1381186.56907114,
        1381222.21040789,  1381257.80879609,  1381293.62111103,
        1381329.26039328,  1381364.83233796,  1381400.39612211,
        1381436.24568798,  1381471.64508092,  1381507.08575138,
        1381542.6274792 ,  1381578.58341573,  1381614.43867004,
        1381650.2101188 ,  1381685.75998913,  1381721.26902617,
        1381756.74170456,  1381792.3060374 ,  1381828.28174894,
        1381864.22125476,  1381899.69319048,  1381935.95209665,
        1381972.11536179,  1382007.75732889,  1382044.23628764,
        1382080.87841754,  1382117.05841576,  1382152.41821813,
        1382187.04780057,  1382221.05510803,  1382254.3457472 ,
        1382286.90420003,  1382318.62853049,  1382349.58371556,
        1382379.84992845,  1382408.94852062,  1382436.905748  ,
        1382464.20981573,  1382490.68547373,  1382516.42898796,
        1382540.94645644,  1382563.87330105,  1382585.84828965,
        1382606.73675023,  1382626.37294054,  1382645.78655037,
        1382664.16215475,  1382680.98307601,  1382696.73415053,
        1382711.21256609,  1382724.95949866,  1382737.94822297,
        1382749.49938941,  1382759.91042147,  1382769.41960791,
        1382778.38059685,  1382787.5733205 ,  1382796.38527543,
        1382805.76263118,  1382815.15298148,  1382824.52558659,
        1382834.0063612 ,  1382843.20282192,  1382852.90112146,
        1382862.61747224,  1382872.71820965,  1382883.21663648,
        1382894.11581627,  1382904.67728344,  1382915.09311889,
        1382925.10079269,  1382934.80362702,  1382944.27330877,
        1382953.60867614,  1382962.76427005,  1382971.56141796,
        1382979.82341625,  1382989.14285524,  1382999.27846017,
        1383009.81380948,  1383020.58352224,  1383031.36372671,
        1383043.11364515,  1383054.78022272,  1383066.0270795 ,
        1383077.30684052,  1383088.35166002,  1383098.93931628,
        1383109.24113405,  1383119.12977686,  1383128.51046209,
        1383137.57811115,  1383146.24546864,  1383154.64699737,
        1383162.72946065,  1383170.23181531,  1383179.41722408,
        1383188.53753883,  1383197.19813436,  1383206.36679657,
        1383214.93538484,  1383222.87689412,  1383230.09095392,
        1383236.58513987,  1383242.23750696,  1383245.97851567,
        1383248.77789349,  1383249.97301359,  1383249.701377  ,
        1383248.14673468,  1383244.96244995,  1383240.19403629,
        1383233.52181712,  1383224.80718834,  1383214.77272713,
        1383202.68672703,  1383189.81630326,  1383176.10156647,
        1383161.59265707,  1383146.03284556])

    AEP_shear = np.array([ 1380658.88138844,  1380628.899539  ,  1380600.43539763,
        1380572.37094322,  1380544.05364761,  1380515.44743364,
        1380486.51913453,  1380457.42765755,  1380428.14138535,
        1380398.93588288,  1380369.46345811,  1380340.22310912,
        1380311.00276581,  1380281.7981083 ,  1380253.27104804,
        1380224.16201182,  1380193.93282275,  1380163.74878269,
        1380133.25647532,  1380102.3471926 ,  1380071.52437273,
        1380040.5586648 ,  1380008.91539768,  1379976.18898679,
        1379941.63624338,  1379905.20186284,  1379868.68873113,
        1379831.3251683 ,  1379795.00052072,  1379758.62114021,
        1379722.42788951,  1379686.25644201,  1379649.78794334,
        1379613.50204718,  1379577.37004311,  1379540.8111528 ,
        1379504.64562141,  1379469.03795769,  1379433.19121362,
        1379397.71457925,  1379362.51252105,  1379328.79708386,
        1379299.2489747 ,  1379271.0216068 ,  1379244.42791651,
        1379219.1114494 ,  1379197.82802236,  1379177.91183165,
        1379159.01954178,  1379140.85369869,  1379123.58561626,
        1379108.49624334,  1379096.30100451,  1379085.67134974,
        1379077.15504232,  1379069.40548614,  1379063.54753877,
        1379058.94759876,  1379054.82375039,  1379053.97069255,
        1379055.66725799,  1379057.5418747 ,  1379059.01804996,
        1379060.14300242,  1379060.56366339,  1379060.76786114,
        1379060.98965633,  1379060.75832259,  1379061.7686613 ,
        1379063.25489898,  1379064.83649982,  1379065.69338764,
        1379065.99387956,  1379066.29371666,  1379067.24309081,
        1379068.82079858,  1379071.59112742,  1379076.72774086,
        1379082.66424632,  1379088.17668496,  1379093.51728764,
        1379098.6311416 ,  1379102.97799692,  1379106.38315596,
        1379109.32519006,  1379110.63350491,  1379110.21359082,
        1379108.461119  ,  1379105.52209512,  1379101.31084074,
        1379100.17386516,  1379100.29821593,  1379101.05049494,
        1379102.00291562,  1379103.09657059,  1379106.69988975,
        1379110.98146045,  1379116.26729904,  1379123.72988016,
        1379132.01637418,  1379142.88672475,  1379158.34724821,
        1379175.29325763,  1379192.35496994,  1379209.18503502,
        1379225.95760057,  1379242.95779727,  1379260.10940846,
        1379278.00851861,  1379297.82671203,  1379317.2996288 ,
        1379339.7922133 ,  1379363.44282758,  1379388.78717459,
        1379415.34686326,  1379442.2039266 ,  1379469.5097547 ,
        1379496.53370906,  1379523.88773684,  1379550.94188183,
        1379578.12997871,  1379608.27053206,  1379638.58258646,
        1379671.36433796,  1379705.59329417,  1379739.67967206,
        1379773.20570218,  1379808.80819858,  1379844.76651273,
        1379880.71224409,  1379916.49557079,  1379952.45568608,
        1379988.88034869,  1380026.36600822,  1380065.12864299,
        1380104.6652932 ,  1380145.46154563,  1380186.785097  ,
        1380228.7921647 ,  1380271.34434488,  1380314.99440946,
        1380359.38135813,  1380403.73321751,  1380448.17565633,
        1380494.11675402,  1380540.92066853,  1380587.45143989,
        1380634.10163668,  1380682.34649524,  1380731.1742783 ,
        1380780.40681703,  1380831.41049484,  1380885.31152514,
        1380939.80533408,  1380993.30580985,  1381045.42782608,
        1381098.37692446,  1381150.54212008,  1381203.93464753,
        1381257.58136183,  1381311.97701136,  1381366.02205337,
        1381419.9160041 ,  1381472.28574619,  1381523.26251504,
        1381573.04653941,  1381622.0540294 ,  1381670.77856956,
        1381718.38152504,  1381766.23076361,  1381813.9600838 ,
        1381860.98324662,  1381907.13694113,  1381953.5462114 ,
        1382001.38541798,  1382049.74793041,  1382098.89112361,
        1382148.36390421,  1382196.68066245,  1382243.68573615,
        1382289.48306882,  1382334.44701755,  1382378.66659039,
        1382422.09329897,  1382465.51753256,  1382508.12787798,
        1382550.09792017,  1382591.97146882,  1382632.66924349,
        1382673.71683486,  1382715.77844635,  1382757.59100267,
        1382798.19909838,  1382837.10710657,  1382874.07721027,
        1382909.03256178,  1382944.2477578 ,  1382981.45069607,
        1383014.74520529,  1383044.33073436])

    AEP_rot = np.array([ 1385102.26029412,  1385030.28152191,  1384964.71147097,
        1384913.26498365,  1384869.09487537,  1384829.49311562,
        1384793.69809339,  1384761.80680224,  1384731.55678708,
        1384702.82257797,  1384680.69054198,  1384665.57757906,
        1384648.79328419,  1384634.751077  ,  1384626.76451201,
        1384623.28907323,  1384622.03381943,  1384616.77163228,
        1384611.89134245,  1384609.59490519,  1384613.69076131,
        1384620.7286478 ,  1384632.50551687,  1384651.06955323,
        1384672.14600793,  1384695.07121561,  1384720.88842073,
        1384750.95476526,  1384786.23906884,  1384821.79194084,
        1384856.56894546,  1384892.07692366,  1384927.38265397,
        1384964.80361488,  1385000.94900655,  1385037.9664144 ,
        1385077.58715509,  1385116.67537648,  1385156.19675863,
        1385194.51944216,  1385232.57202376,  1385266.52341163,
        1385301.10588306,  1385345.9195551 ,  1385395.36467799,
        1385451.99318013,  1385511.43191782,  1385573.07777314,
        1385634.78880589,  1385696.82765316,  1385759.49871393,
        1385824.27687423,  1385878.85035154,  1385884.17706182,
        1385861.11224647,  1385826.50590546,  1385798.85412653,
        1385776.19134176,  1385756.64288494,  1385743.07186213,
        1385722.63303946,  1385702.68845134,  1385685.59286841,
        1385667.30088526,  1385639.84840688,  1385602.11184033,
        1385568.33012955,  1385537.2274989 ,  1385496.33809728,
        1385441.96817381,  1385380.79400592,  1385326.79599631,
        1385271.96815666,  1385209.76420226,  1385147.20402292,
        1385077.14381647,  1385000.31240652,  1384924.98377897,
        1384850.13918043,  1384776.04499374,  1384693.83014653,
        1384607.78242778,  1384514.0730715 ,  1384410.1227144 ,
        1384303.03042107,  1384194.53966005,  1384081.77575797,
        1383964.23345069,  1383841.44552471,  1383714.90376434,
        1383582.77338509,  1383443.05676332,  1383306.03859375,
        1383162.65346892,  1383017.77271659,  1382878.79758497,
        1382741.37175332,  1382606.92838081,  1382477.27129252,
        1382352.15969194,  1382230.83196958,  1382111.93744715,
        1381994.07784105,  1381880.3508731 ,  1381772.36539115,
        1381669.97763064,  1381573.71853037,  1381483.46487234,
        1381396.08276426,  1381311.49662144,  1381229.41299929,
        1381149.56522683,  1381072.65780982,  1380999.41462742,
        1380927.68232136,  1380860.90938793,  1380801.82592868,
        1380746.60142755,  1380691.51814819,  1380635.288718  ,
        1380582.97032902,  1380534.04109525,  1380487.19144059,
        1380447.83700068,  1380418.24054665,  1380397.13916986,
        1380379.32916922,  1380366.29436206,  1380360.9631064 ,
        1380351.01363529,  1380329.89018832,  1380307.52705614,
        1380283.25591791,  1380265.47331658,  1380255.19819706,
        1380248.34981082,  1380244.4594854 ,  1380237.75704507,
        1380247.49535574,  1380262.21547142,  1380273.61264856,
        1380291.2572832 ,  1380315.04440286,  1380345.71733255,
        1380384.30520667,  1380431.28176219,  1380474.98784764,
        1380480.72044805,  1380444.49824403,  1380407.68489778,
        1380377.38969982,  1380357.29265446,  1380342.23045053,
        1380332.57149023,  1380328.58815042,  1380334.77039557,
        1380344.36478561,  1380353.51657213,  1380366.69338411,
        1380383.45922113,  1380404.53885105,  1380426.09239361,
        1380448.10304655,  1380469.64261414,  1380492.2814891 ,
        1380515.36079812,  1380537.79996951,  1380564.19619025,
        1380595.74902191,  1380634.21729767,  1380674.06842609,
        1380714.91059507,  1380757.83212928,  1380804.1311434 ,
        1380853.86790878,  1380908.66302461,  1380965.95625408,
        1381025.30562181,  1381086.07355571,  1381149.21635396,
        1381216.88754637,  1381285.61787137,  1381356.27698288,
        1381429.24161393,  1381502.50781796,  1381576.58443398,
        1381652.39084292,  1381729.20385518,  1381803.73433022,
        1381875.80652429,  1381942.07743299,  1382004.59813471,
        1382071.22389393,  1382142.15009633,  1382214.53937804,
        1382292.0402508 ,  1382372.43926241,  1382457.55553229,
        1382545.77853709,  1382635.98688656])

    AEP_start = np.array([1382792.62875479,  1382837.084754  ,  1382883.32851408,
        1382930.26783325,  1382977.00336878,  1383027.36843932,
        1383078.81144897,  1383129.99695197,  1383181.25874553,
        1383233.43885664,  1383284.87942932,  1383335.34214402,
        1383381.18016575,  1383427.11641844,  1383474.37499029,
        1383520.34000493,  1383565.44109278,  1383609.42556245,
        1383652.80385354,  1383695.87521647,  1383737.37906624,
        1383774.05212857,  1383805.44120713,  1383836.64838148,
        1383868.9777338 ,  1383898.72654478,  1383925.66215039,
        1383949.89514142,  1383973.00702913,  1383997.43371413,
        1384020.17822011,  1384041.15068966,  1384059.70113304,
        1384076.84151511,  1384092.53265406,  1384105.90713353,
        1384117.57258127,  1384128.19990901,  1384138.2937838 ,
        1384144.78167486,  1384149.98180547,  1384156.0465562 ,
        1384161.20377949,  1384165.21811922,  1384166.6313897 ,
        1384166.11374855,  1384164.50669001,  1384159.69888083,
        1384151.73241463,  1384140.32320822,  1384123.19682188,
        1384105.86188093,  1384088.27666984,  1384069.63172052,
        1384050.51718319,  1384030.28869677,  1384008.81795435,
        1383986.56703209,  1383961.9551437 ,  1383935.45887433,
        1383907.38321658,  1383877.20294308,  1383846.45176739,
        1383814.07902239,  1383779.64806357,  1383735.23018284,
        1383689.60483752,  1383642.73866813,  1383590.61061501,
        1383536.0776211 ,  1383480.41972169,  1383423.72413078,
        1383365.42160961,  1383305.14107645,  1383243.54342404,
        1383180.45406366,  1383116.15126449,  1383055.78194821,
        1382997.19382921,  1382940.14030834,  1382884.29728411,
        1382830.04615776,  1382777.24641782,  1382725.95041182,
        1382678.61969431,  1382636.88096882,  1382597.67570124,
        1382560.35504596,  1382524.40191356,  1382492.37887294,
        1382462.08877711,  1382434.16258507,  1382409.19214857,
        1382386.61883076,  1382367.58623438,  1382350.77946458,
        1382336.37892761,  1382322.29033984,  1382308.94324774,
        1382296.46225351,  1382282.98050862,  1382268.18046157,
        1382255.07435261,  1382244.01098186,  1382235.19710553,
        1382229.07571337,  1382225.0747963 ,  1382223.37117379,
        1382224.61797377,  1382228.87943764,  1382237.48946736,
        1382248.02003238,  1382259.84038231,  1382273.48605844,
        1382290.19346535,  1382308.72634901,  1382327.64613522,
        1382346.30343687,  1382365.30332936,  1382383.58627975,
        1382402.52175266,  1382421.32577284,  1382441.4479894 ,
        1382462.24460652,  1382484.06434231,  1382503.88447736,
        1382520.99610992,  1382536.26729934,  1382549.45463612,
        1382560.62919686,  1382570.38050502,  1382578.23173839,
        1382585.32748647,  1382591.53582198,  1382596.85933886,
        1382600.10496465,  1382601.73675662,  1382603.7653407 ,
        1382605.88788214,  1382605.98258111,  1382601.7978705 ,
        1382593.88108026,  1382582.16162012,  1382568.45875076,
        1382552.95221858,  1382535.08580022,  1382515.47875296,
        1382493.78641758,  1382469.81564184,  1382445.12082121,
        1382420.53292559,  1382397.19400314,  1382375.30259096,
        1382354.37523848,  1382335.69134907,  1382320.75214278,
        1382307.70114038,  1382296.09048932,  1382286.34606613,
        1382279.87155075,  1382278.0215114 ,  1382279.00570972,
        1382280.90353518,  1382278.7908062 ,  1382279.75732389,
        1382285.35296138,  1382292.65396425,  1382302.01355371,
        1382313.68978241,  1382327.63769436,  1382344.20497199,
        1382364.49242501,  1382386.38308712,  1382409.93888779,
        1382436.89982123,  1382465.65897255,  1382495.4140197 ,
        1382527.50264502,  1382563.00783964,  1382601.24015684,
        1382640.79125872,  1382677.55658468,  1382715.87601949,
        1382757.32886634,  1382800.5524993 ,  1382845.35409232,
        1382891.67026089,  1382938.70991977,  1382985.54258075,
        1383036.57447896,  1383088.0067125 ,  1383139.13087014,
        1383190.58163739,  1383242.72163239,  1383294.06308211,
        1383343.6777057 ,  1383389.28437567,  1383435.67407444,
        1383482.68368629,  1383528.38223519])

    import matplotlib as mpl
    mpl.rc('font', family = 'serif', serif = 'cmr10')
    plt.rcParams["mathtext.fontset"] = "dejavuserif"
    fig = plt.figure(figsize=[6.5,4.])
    ax21 = plt.subplot2grid((3, 10), (1, 0),colspan=2)
    ax22 = plt.subplot2grid((3, 10), (1, 2),colspan=2)
    ax23 = plt.subplot2grid((3, 10), (1, 4),colspan=2)
    ax24 = plt.subplot2grid((3, 10), (1, 6),colspan=2)
    ax25 = plt.subplot2grid((3, 10), (1, 8),colspan=2)


    ax21.plot(d_dx,AEP_dx,color='C0',alpha=0.5)
    ax21.set_xticks([2.,2.5,3.])
    ax21.set_xticklabels(['2D','2.5D','3D'])
    ax21.set_xlabel(r'$dx$',fontsize=8)

    ax22.plot(d_dy,AEP_dy,color='C0',alpha=0.5)
    ax22.set_xticks([8.,9.,10.])
    ax22.set_xticklabels(['8D','9D','10D'])
    ax22.set_xlabel(r'$dy$',fontsize=8)

    ax23.plot(d_shear,AEP_shear,color='C0',alpha=0.5)
    ax23.set_xticks([2.,3.,4.])
    ax23.set_xticklabels(['2D','3D','4D'])
    ax23.set_xlabel(r'$b$',fontsize=8)

    ax24.plot(d_rot,AEP_rot,color='C0',alpha=0.5)
    ax24.set_xticks([-10.,0.,10.])
    ax24.set_xticklabels([r'-10$^\circ$',r'0$^\circ$',r'10$^\circ$'])
    ax24.set_xlabel(r'$\theta$',fontsize=8)

    ax25.plot(d_start,AEP_start,color='C0',alpha=0.5)
    ax25.set_xticks([-2.,0.,2.])
    ax25.set_xticklabels(['-2D','0','2D'])
    ax25.set_xlabel(r'$s$',fontsize=8)

    ax21.set_xlim(2.,3.)
    ax22.set_xlim(8.,10.)
    ax23.set_xlim(2.,4.)
    ax24.set_xlim(-10.,10.)
    ax25.set_xlim(-2.,2.)

    ax21.set_yticks([1365000.,1375000.,1385000.])
    ax22.set_yticks([1365000.,1375000.,1385000.])
    ax23.set_yticks([1365000.,1375000.,1385000.])
    ax24.set_yticks([1365000.,1375000.,1385000.])
    ax25.set_yticks([1365000.,1375000.,1385000.])

    ax21.set_yticklabels(['1365','1375','1385'])
    ax22.set_yticklabels(['','',''])
    ax23.set_yticklabels(['','',''])
    ax24.set_yticklabels(['','',''])
    ax25.set_yticklabels(['','',''])
    #
    ax21.set_ylim(1365000.,1387000.)
    ax22.set_ylim(1365000.,1387000.)
    ax23.set_ylim(1365000.,1387000.)
    ax24.set_ylim(1365000.,1387000.)
    ax25.set_ylim(1365000.,1387000.)

    ax21.set_ylabel('AEP (GWh)',fontsize=8)
    #
    ax31 = plt.subplot2grid((3, 10), (2, 3),colspan=2)
    ax32 = plt.subplot2grid((3, 10), (2, 5),colspan=2)

    d_x = np.linspace(-2916.77457115,2916.77457115,num)
    d_y = np.linspace(-3752.34924936,3752.34924936,num)

    AEP_x = np.array([1345007.43469253,  1344477.90434529,               1344477.90434529,
        1344522.32649628,  1345062.55787602,  1345963.2015593 ,
        1346816.80249621,  1347305.89618453,  1347473.98249841,
        1347502.3364152 ,  1347435.87926415,  1347336.3902033 ,
        1347220.95414963,  1347119.00300069,  1346928.85475003,
        1346685.06977566,  1346380.81638993,  1346015.97718538,
        1345683.80900278,  1345380.9342986 ,  1345076.31282626,
        1345123.76096528,  1345307.65801367,  1345701.54044611,
        1346024.36655705,  1346269.00565774,  1346510.03059707,
        1346656.37716066,  1346664.73722117,  1346678.45083467,
        1346650.92312441,  1346579.89791944,  1346553.84382667,
        1346510.94388742,  1346433.14958701,  1346278.79815963,
        1346130.79584256,  1346049.84166076,  1345995.80203679,
        1345941.20896091,  1345963.55299286,  1345997.16553498,
        1346018.70648407,  1346002.9674294 ,  1346083.03591141,
        1346213.89902481,  1346397.1169047 ,  1346525.75828558,
        1346630.63626019,  1346662.16080728,  1346614.81780703,
        1346515.5759771 ,  1346388.05606836,  1346294.81094486,
        1346239.06526216,  1346205.42849078,  1346223.17304022,
        1346330.70138972,  1346361.23128729,  1346346.72401239,
        1346325.25476273,  1346270.61941334,  1346219.81630099,
        1346258.43456541,  1346307.32570228,  1346367.89182581,
        1346472.09890296,  1346560.54593701,  1346590.98072347,
        1346559.7768337 ,  1346482.16704317,  1346345.78527036,
        1346159.1785784 ,  1345974.45439334,  1345819.76551857,
        1345773.00724017,  1345797.88504789,  1345776.42603805,
        1345756.59392316,  1345797.4649785 ,  1345871.37933806,
        1345901.37919111,  1346022.48855535,  1346203.48575741,
        1346344.75743676,  1346392.02999298,  1346421.60432574,
        1346432.25155598,  1346427.01062998,  1346369.89176694,
        1346305.55472285,  1346134.0337464 ,  1345858.73107877,
        1345509.84629194,  1345283.51868058,  1345017.89308792,
        1344799.76833501,  1344684.82478903,  1345003.45510473,
        1345294.72757248,  1345598.15515876,  1345905.53193071,
        1346151.80530992,  1346338.86053195,  1346529.34942457,
        1346652.15757389,  1346741.72059216,  1346829.98190924,
        1346897.29633741,  1346940.77222234,  1346958.22466357,
        1346961.168634  ,  1346977.25902668,  1347016.40140567,
        1347051.41878113,  1347081.81187256,  1347089.70173473,
        1347092.57250623,  1347110.11396557,  1347095.63645026,
        1347096.14949518,  1347091.7673848 ,  1347088.48755841,
        1347016.93856226,  1346931.86196676,  1346816.33941076,
        1346717.77544873,  1346586.43953978,  1346391.91256257,
        1346207.77001476,  1345976.30808429,  1345653.14723399,
        1345346.08275423,  1345059.84685787,  1344817.50760594,
        1344912.73837443,  1345248.83631814,  1345507.20091238,
        1345825.19128264,  1346156.44905318,  1346453.16094007,
        1346572.05061363,  1346586.5297131 ,  1346611.69520117,
        1346595.13960514,  1346571.23414698,  1346553.55570306,
        1346525.27703666,  1346414.81571301,  1346259.96458969,
        1346146.08936604,  1346135.60780834,  1346104.42242724,
        1346065.16372443,  1346094.65269989,  1346152.48100743,
        1346202.06857969,  1346281.96681804,  1346452.7247408 ,
        1346616.19872246,  1346818.04829935,  1346960.8306902 ,
        1347042.16287023,  1347049.03545048,  1346973.03415405,
        1346833.2407777 ,  1346672.00845191,  1346572.65854955,
        1346521.77013359,  1346524.82048075,  1346657.59703959,
        1346824.46822474,  1346922.00938364,  1346953.42073452,
        1346893.71129803,  1346835.75771916,  1346846.70738437,
        1346893.92398194,  1346977.50252391,  1347140.75315699,
        1347371.23022525,  1347531.88872937,  1347605.0641598 ,
        1347579.61815326,  1347497.0175393 ,  1347344.78031745,
        1347131.08777121,  1346877.4083592 ,  1346717.89127609,
        1346788.59399048,  1346906.13663168,  1346963.84564259,
        1347033.02485599,  1347180.46374314,  1347262.24393037,
        1347369.83723156,  1347625.93257314,  1348019.91209185,
        1348383.15991063,  1348647.34856706 ])

    AEP_y = np.array([1348818.57869565,  1348554.27877293,  1348292.29741122,
        1348033.92809015,  1347623.74460089,  1346983.31865752,
        1346094.87723502,  1345493.35764193,  1345327.32997611,
        1345643.78021538,  1346189.08572525,  1346550.53632053,
        1346827.05631694,  1347116.801111  ,  1347283.94755733,
        1347344.95811517,  1347304.59364256,  1347087.84860725,
        1346734.52274753,  1346306.61028929,  1345761.02277863,
        1345048.68555664,  1344371.17785943,  1344039.96051938,
        1344326.14183367,               1344326.14183367,  1345210.65809595,
        1345738.9266603 ,  1346086.44098051,  1346323.32684074,
        1346512.64241795,  1346653.50948352,  1346701.56592416,
        1346653.66310006,  1346491.61291775,  1346285.26747077,
        1346164.62028648,  1346126.70556611,  1346030.68875765,
        1346086.61937026,  1346205.91012891,  1346285.07362371,
        1346335.80367318,  1346361.49518881,  1346452.12630745,
        1346518.90937918,  1346560.72661868,  1346580.48817023,
        1346594.17529777,  1346628.56493348,  1346614.47362282,
        1346557.07129094,  1346518.4088097 ,  1346545.86707627,
        1346547.33308263,  1346596.74223453,  1346578.54824096,
        1346503.44954261,  1346552.72214719,  1346632.13445261,
        1346688.34943863,  1346736.73863628,  1346770.55330851,
        1346790.16121941,  1346746.09327328,  1346682.47334203,
        1346604.14478634,  1346513.94381524,  1346475.47086608,
        1346471.93408416,  1346424.96330987,  1346352.27900293,
        1346323.01129914,  1346291.58432728,  1346384.81169205,
        1346474.27758979,  1346476.74399683,  1346447.59236073,
        1346393.93091104,  1346347.79284207,  1346271.72925822,
        1346244.74377864,  1346177.32627053,  1345977.27370241,
        1345865.58989202,  1345642.75071343,  1345474.64822953,
        1345465.22372281,  1345601.16266201,  1345782.57509375,
        1345996.65048835,  1346221.36477902,  1346515.38099053,
        1346695.38150811,  1346839.568208  ,  1346938.30327279,
        1347010.88292351,  1347040.56183595,  1347038.58511425,
        1347046.52847452,  1347079.79404282,  1347089.75217433,
        1347082.06569761,  1347046.55662073,  1347007.33599897,
        1346973.74275364,  1346966.5065848 ,  1346974.42117538,
        1346962.75530085,  1346890.01496736,  1346763.31873451,
        1346597.21833019,  1346355.95083708,  1346075.9688466 ,
        1345859.26027098,  1345643.65473532,  1345464.29674608,
        1345374.64704266,  1345466.13033546,  1345674.50848806,
        1345784.31265168,  1345980.49727419,  1346112.32017112,
        1346146.44245304,  1346214.13423821,  1346268.20795835,
        1346336.91090795,  1346395.06750263,  1346461.59977858,
        1346456.31100763,  1346386.8415597 ,  1346405.25012918,
        1346430.47953164,  1346497.88238862,  1346587.50851809,
        1346574.40387957,  1346567.65620399,  1346689.33446244,
        1346760.34752513,  1346822.73895174,  1346897.85956856,
        1346930.87379387,  1346866.00670615,  1346775.3999648 ,
        1346693.35465773,  1346613.88073687,  1346571.4037673 ,
        1346597.00930039,  1346619.90476799,  1346581.56678182,
        1346552.65834979,  1346561.80203848,  1346633.84209879,
        1346731.564141  ,  1346794.87511947,  1346774.19643804,
        1346709.30210788,  1346677.65688313,  1346685.28124963,
        1346692.24587912,  1346691.31887692,  1346655.22538467,
        1346566.71146875,  1346491.58963354,  1346335.94899084,
        1346176.39040175,  1346188.92932125,  1346232.98686421,
        1346391.80052783,  1346637.42393049,  1346848.04345008,
        1346956.29072636,  1346960.05389914,  1346949.47104318,
        1346901.48895471,  1346800.85164552,  1346562.23007416,
        1346077.60742883,  1345300.79699073,  1345216.30621018,
        1344753.4785505 ,  1344715.25279866,  1345422.97135258,
        1346315.32340127,  1347024.78170645,  1347490.7747398 ,
        1347847.46358767,  1348153.20403022,  1348423.35930374,
        1348685.26253803,  1348856.55660585,  1348998.3247932 ,
        1349138.69597712,  1349286.78764222,  1349442.78635688,
        1349584.8460397 ,  1349717.19140624,  1349846.95229659,
        1349957.33941311,  1350019.35069899])

    ax31.plot(d_x,AEP_x,color='C2',alpha=0.5)
    ax32.plot(d_y,AEP_y,color='C2',alpha=0.5)

    ax31.set_yticks([1344000.,1347000.,1350000.])
    ax32.set_yticks([1344000.,1347000.,1350000.])

    ax31.set_yticklabels(['1344','1347','1350'])
    ax32.set_yticklabels(['','',''])

    ax31.set_ylim(1344000.,1350000.)
    ax32.set_ylim(1344000.,1350000.)

    ax31.set_xlim(min(d_x),max(d_x))
    ax32.set_xlim(min(d_y),max(d_y))

    ax31.set_xticks((-2000.,0.,2000.))
    ax32.set_xticks((-2500.,0.,2500.))

    ax31.set_xticklabels(['-2000','0','2000'])
    ax32.set_xticklabels(['-2500','0','2500'])

    ax31.set_ylabel('AEP (GWh)',fontsize=8)

    ax11 = plt.subplot2grid((3, 10), (0, 1),colspan=2)
    ax12 = plt.subplot2grid((3, 10), (0, 3),colspan=2)
    ax13 = plt.subplot2grid((3, 10), (0, 5),colspan=2)
    ax14 = plt.subplot2grid((3, 10), (0, 7),colspan=2)

    d_dx = np.linspace(2.5,4.5,num)
    d_dy = np.linspace(2.5,4.5,num)
    d_shear = np.linspace(1.,2.,num)
    d_rot = np.linspace(-10.,10.,num)

    AEP_dx = np.array([1206606.96672513,  1207486.77444064,  1208358.97795217,
        1209227.43486414,  1210088.15705603,  1210938.76568109,
        1211778.65585759,  1212607.03662728,  1213422.93744608,
        1214226.18024391,  1215021.40024739,  1215803.3430328 ,
        1216573.42485308,  1217331.7840715 ,  1218081.64543102,
        1218820.19230133,  1219546.70817153,  1220261.16244309,
        1220964.17078312,  1221655.36243823,  1222336.04089695,
        1223011.26151447,  1223676.10950905,  1224332.97164707,
        1224980.24803128,  1225619.07623241,  1226254.67555377,
        1226885.18843522,  1227507.0915907 ,  1228120.75622394,
        1228725.14669742,  1229318.90548843,  1229901.58839239,
        1230474.90338523,  1231039.61516795,  1231596.94114569,
        1232147.9953963 ,  1232692.85807365,  1233232.93751193,
        1233766.62359172,  1234291.94879736,  1234810.04188385,
        1235320.65124351,  1235825.05784902,  1236324.00098386,
        1236817.67259095,  1237307.3433663 ,  1237792.34273088,
        1238271.1717197 ,  1238745.94991006,  1239217.8193361 ,
        1239686.58896929,  1240147.94162619,  1240600.28394963,
        1241045.81297628,  1241493.43852519,  1241937.21604924,
        1242381.77254706,  1242824.97065557,  1243267.38293374,
        1243708.79579354,  1244152.71580234,  1244601.74749705,
        1245063.82910634,  1245537.08776178,  1246014.89945653,
        1246499.10002335,  1247028.09400143,  1247572.14132899,
        1248118.52332045,  1248668.33242746,  1249222.18585596,
        1249781.68237686,  1250353.35118612,  1250933.21496175,
        1251517.55072651,  1252107.15833225,  1252704.47421407,
        1253307.17157825,  1253915.47395452,  1254528.42215439,
        1255145.97407636,  1255768.08185944,  1256396.67934922,
        1257032.01366892,  1257670.53826616,  1258312.70566154,
        1258958.54472729,  1259607.01656294,  1260258.30492384,
        1260911.44227326,  1261566.68855984,  1262224.01188737,
        1262882.64887932,  1263541.15128942,  1264204.12623381,
        1264873.17204135,  1265543.59184151,  1266216.1740359 ,
        1266893.13596448,  1267577.11623363,  1268272.05811602,
        1268970.78074099,  1269671.69539642,  1270374.54522199,
        1271079.06765751,  1271785.02132927,  1272492.13673016,
        1273200.16712658,  1273908.88546728,  1274618.04288114,
        1275327.39017616,  1276036.67795626,  1276745.65582889,
        1277454.06784476,  1278161.65640187,  1278868.15226786,
        1279573.25821422,  1280276.60295087,  1280977.46826373,
        1281676.37810279,  1282373.48308005,  1283068.58453003,
        1283761.49494907,  1284452.15103239,  1285142.04806026,
        1285829.32715634,  1286516.27598224,  1287200.46647715,
        1287881.52652913,  1288559.31371361,  1289233.68947002,
        1289904.52297544,  1290571.68951384,  1291235.07464924,
        1291895.38798821,  1292555.51658235,  1293212.03993212,
        1293864.2991451 ,  1294512.23403233,  1295155.8015837 ,
        1295794.96492463,  1296429.69467549,  1297059.96767828,
        1297685.77012665,  1298307.09851075,  1298923.95409348,
        1299539.02627464,  1300152.70679616,  1300763.23230166,
        1301369.07073017,  1301970.25434023,  1302566.81748855,
        1303158.79611307,  1303746.12724355,  1304327.16791611,
        1304904.35822773,  1305478.07381033,  1306046.66645648,
        1306610.24571793,  1307168.9295899 ,  1307722.85452362,
        1308272.22024757,  1308817.12847127,  1309357.91178468,
        1309894.59183827,  1310427.0574158 ,  1310954.82497328,
        1311478.14779031,  1311996.96783157,  1312511.89011393,
        1313023.58448032,  1313534.0858805 ,  1314042.03754552,
        1314547.68824029,  1315051.00916417,  1315550.96399649,
        1316047.80233085,  1316541.28376352,  1317030.36151862,
        1317514.81961345,  1317995.28596344,  1318472.09676374,
        1318945.42357013,  1319415.37473479,  1319882.39885089,
        1320346.97170597,  1320808.49201184,  1321266.98688696,
        1321722.44879315,  1322174.789238  ,  1322623.74286891,
        1323068.94449936,  1323511.12842193,  1323950.59252147,
        1324387.33334666,  1324822.05563614,  1325258.91745153,
        1325693.66495791,  1326128.23676956])

    AEP_dy = np.array([1208000.95307666,  1208730.36293514,  1209458.38444749,
        1210184.38323625,  1210909.02320758,  1211632.61525223,
        1212356.00008021,  1213083.29977778,  1213815.36205176,
        1214547.07415156,  1215278.55996557,  1216012.02597915,
        1216748.05817782,  1217484.1763764 ,  1218220.48292108,
        1218957.07525893,  1219694.66760953,  1220435.12025058,
        1221182.49873358,  1221931.803288  ,  1222692.74129541,
        1223454.97774084,  1224216.63839873,  1224978.18323077,
        1225739.83492999,  1226501.68110189,  1227263.44857621,
        1228024.3693395 ,  1228784.20169361,  1229543.37409912,
        1230302.02155983,  1231060.20034341,  1231825.40171043,
        1232596.264779  ,  1233376.67306157,  1234162.7237114 ,
        1234947.36296921,  1235730.48449772,  1236515.5417288 ,
        1237299.17601893,  1238080.8727864 ,  1238866.00500879,
        1239652.5122039 ,  1240436.14254289,  1241217.13273299,
        1241998.09049158,  1242780.7037275 ,  1243566.1728739 ,
        1244349.03650235,  1245128.12386789,  1245903.72845064,
        1246675.66798319,  1247446.0302759 ,  1248212.9570908 ,
        1248977.92696498,  1249738.97904351,  1250496.71902077,
        1251252.98335955,  1252009.85067102,  1252762.8155475 ,
        1253511.70269904,  1254256.32711831,  1254996.48690515,
        1255731.61118636,  1256460.81683343,  1257184.4812049 ,
        1257902.47727426,  1258614.34018142,  1259320.22328618,
        1260020.03853003,  1260714.35505693,  1261403.12490324,
        1262086.05959313,  1262762.75224803,  1263432.42102394,
        1264095.03700859,  1264748.93991872,  1265396.48305878,
        1266039.17443853,  1266676.92234023,  1267309.64151759,
        1267937.24918018,  1268559.6700355 ,  1269176.8304309 ,
        1269788.66050564,  1270394.83081401,  1270994.62813993,
        1271588.42531828,  1272176.27865598,  1272757.73245773,
        1273332.904165  ,  1273901.92951438,  1274464.84955021,
        1275021.24603197,  1275570.54794002,  1276113.22691355,
        1276648.35829847,  1277174.49067789,  1277692.8949835 ,
        1278203.97324554,  1278707.78830794,  1279203.81659824,
        1279692.12350728,  1280172.61506344,  1280645.625476  ,
        1281111.23800676,  1281570.85254872,  1282022.86817835,
        1282467.65055137,  1282905.33091925,  1283336.14954461,
        1283760.2443178 ,  1284177.49209498,  1284587.85146636,
        1284991.55828889,  1285393.37896135,  1285788.95908989,
        1286177.42841552,  1286559.17301659,  1286936.49466737,
        1287309.42216391,  1287680.10004277,  1288044.49265286,
        1288402.08148397,  1288754.24365137,  1289100.62051177,
        1289442.67880949,  1289778.95295499,  1290109.3396229 ,
        1290434.01762088,  1290753.15647179,  1291075.2431679 ,
        1291393.1998673 ,  1291706.48845381,  1292017.93346474,
        1292327.723335  ,  1292634.06862764,  1292937.05828308,
        1293243.77304965,  1293552.61238437,  1293860.7727899 ,
        1294173.97149322,  1294484.89130185,  1294793.63296206,
        1295100.36751796,  1295405.26653684,  1295708.50109357,
        1296010.24339882,  1296310.66586631,  1296609.94016466,
        1296909.04882933,  1297208.34851184,  1297507.28907488,
        1297806.61636372,  1298105.53323576,  1298404.20517338,
        1298702.79364518,  1299001.46425645,  1299300.37919124,
        1299599.6983761 ,  1299899.58056598,  1300200.1830659 ,
        1300501.60049112,  1300803.4819248 ,  1301106.2062652 ,
        1301410.02484021,  1301715.12830091,  1302021.6852848 ,
        1302329.8525927 ,  1302639.77772528,  1302951.60117814,
        1303265.45739397,  1303581.47546788,  1303899.7792295 ,
        1304220.48681264,  1304543.71194913,  1304869.5646237 ,
        1305198.1381312 ,  1305529.57088733,  1305863.93359827,
        1306201.31719367,  1306541.80853329,  1306885.49103915,
        1307232.44192625,  1307582.73576705,  1307936.4442039 ,
        1308293.64152542,  1308654.38387248,  1309018.72640802,
        1309386.72027011,  1309758.41231222,  1310133.84377435,
        1310512.50034219,  1310894.53788782,  1311280.14040069,
        1311669.39015217,  1312062.34139608,  1312459.03316538,
        1312859.49466999,  1313263.63392676])

    AEP_shear = np.array([1294766.78885552,  1294736.55206404,  1294705.44749253,
        1294673.79598568,  1294641.89852748,  1294609.20637934,
        1294575.72181609,  1294541.37796207,  1294505.1784881 ,
        1294467.23725722,  1294428.54973947,  1294389.30157665,
        1294349.60043808,  1294309.53593229,  1294269.18832566,
        1294228.63368853,  1294187.85403782,  1294146.65609762,
        1294105.25221829,  1294063.75231476,  1294022.2431843 ,
        1293980.80095638,  1293939.49673826,  1293898.39716588,
        1293857.56986671,  1293817.07920467,  1293776.98823532,
        1293737.35962612,  1293698.25481796,  1293659.73587911,
        1293621.86412135,  1293584.70237658,  1293548.31393957,
        1293512.7833494 ,  1293478.12695793,  1293444.56864819,
        1293412.20859436,  1293380.98997821,  1293350.81324934,
        1293320.77031989,  1293290.88547475,  1293261.55835171,
        1293232.92799283,  1293205.07408403,  1293178.03910923,
        1293151.82478318,  1293126.05553291,  1293099.98247767,
        1293074.23845411,  1293048.54353334,  1293023.2989709 ,
        1292998.65505254,  1292974.70373372,  1292951.50998877,
        1292929.12196577,  1292907.57664676,  1292886.90198956,
        1292867.11849812,  1292848.2412391 ,  1292830.27999455,
        1292813.23987396,  1292797.12250744,  1292781.9263925 ,
        1292767.64671466,  1292754.27605357,  1292741.85051607,
        1292730.31642731,  1292719.6571988 ,  1292709.85849152,
        1292700.90444635,  1292692.77812536,  1292685.46211589,
        1292678.93887965,  1292673.19041127,  1292668.19855067,
        1292663.94456065,  1292660.41021472,  1292657.64009776,
        1292661.88700553,  1292670.19108213,  1292683.34182182,
        1292697.95207284,  1292713.00818565,  1292733.0113892 ,
        1292753.24239816,  1292775.55375641,  1292799.76402424,
        1292828.55489236,  1292861.7011205 ,  1292908.35135284,
        1292955.52380101,  1293003.1823639 ,  1293051.2906868 ,
        1293099.81177103,  1293148.70815018,  1293197.94153064,
        1293247.47319529,  1293297.26364543,  1293347.27296027,
        1293397.46034388,  1293447.78481543,  1293498.20459466,
        1293548.67699203,  1293600.77048245,  1293653.73104196,
        1293706.57255093,  1293759.24785131,  1293811.61934142,
        1293871.21920217,  1293931.64404033,  1293991.72320595,
        1294055.78957382,  1294127.47556157,  1294208.91363786,
        1294294.70593885,  1294379.46632263,  1294463.05523554,
        1294545.24995667,  1294625.56214931,  1294703.86330841,
        1294788.57731622,  1294875.4324245 ,  1294959.07946801,
        1295039.73370968,  1295116.52221881,  1295189.38652608,
        1295258.41777407,  1295324.82433186,  1295388.25188841,
        1295448.90425025,  1295509.86417382,  1295567.32945256,
        1295622.33533755,  1295675.83605277,  1295727.75523307,
        1295778.01358316,  1295826.53245687,  1295873.23710758,
        1295918.04724216,  1295960.95015954,  1296001.92563035,
        1296040.94304388,  1296077.6630657 ,  1296111.92837946,
        1296143.61522107,  1296172.59310681,  1296198.6159116 ,
        1296221.29448314,  1296239.61102807,  1296254.17462855,
        1296264.99247162,  1296272.18121492,  1296277.6784714 ,
        1296281.46457917,  1296283.52057121,  1296283.73681887,
        1296279.81471272,  1296272.38021661,  1296262.00820486,
        1296247.98645658,  1296231.38536622,  1296212.29010221,
        1296190.38248547,  1296165.7528931 ,  1296138.44170096,
        1296108.31078124,  1296074.88332705,  1296038.81257821,
        1296000.27488577,  1295959.41364975,  1295916.29868513,
        1295870.98744917,  1295823.53717891,  1295773.99859698,
        1295722.41935087,  1295667.484988  ,  1295608.57098788,
        1295545.90549374,  1295482.00166106,  1295417.19714117,
        1295350.09536813,  1295279.25278439,  1295204.50156139,
        1295126.50061758,  1295045.739869  ,  1294962.46282269,
        1294880.12031395,  1294802.86614738,  1294724.0419843 ,
        1294643.7340639 ,  1294562.03004153,  1294480.54008273,
        1294401.85140008,  1294330.6904868 ,  1294264.0615655 ,
        1294196.52873747,  1294130.42159113,  1294065.92445497,
        1294000.6776319 ,  1293934.7395084 ])

    AEP_rot = np.array([1297050.68944772,  1296841.55772424,  1296640.68996086,
        1296446.89299672,  1296258.53366842,  1296070.17736759,
        1295882.08323029,  1295694.51833079,  1295508.50065573,
        1295326.71705551,  1295146.15992252,  1294967.10176405,
        1294789.80924099,  1294614.64188943,  1294447.38135801,
        1294282.26334289,  1294119.37261082,  1293958.64838172,
        1293799.94061947,  1293643.96472075,  1293489.35777283,
        1293335.96921302,  1293184.17024796,  1293035.02817066,
        1292888.53245814,  1292748.92184591,  1292614.36076271,
        1292485.34532017,  1292361.84468629,  1292243.68011951,
        1292130.00931929,  1292021.66630118,  1291919.83025589,
        1291824.44292866,  1291738.96189288,  1291662.61879494,
        1291591.66826248,  1291525.17613172,  1291465.39124485,
        1291412.42844711,  1291364.98000211,  1291322.3562056 ,
        1291285.27555841,  1291252.41186603,  1291223.6344492 ,
        1291197.63207385,  1291174.10898817,  1291153.7876701 ,
        1291144.10017962,  1291140.61022367,  1291140.30654012,
        1291143.10464148,  1291147.75244273,  1291155.64529243,
        1291167.11441232,  1291182.0626742 ,  1291200.35249339,
        1291221.6882086 ,  1291244.60576581,  1291269.2592294 ,
        1291296.49187825,  1291327.33980361,  1291360.03609769,
        1291393.90390679,  1291429.31179661,  1291466.32800825,
        1291509.87744693,  1291562.40079395,  1291617.85754724,
        1291695.46122613,  1291787.29991811,  1291894.5956983 ,
        1292010.7127267 ,  1292131.11965696,  1292261.16421208,
        1292420.65074299,  1292583.54305073,  1292742.33279169,
        1292895.62406475,  1293045.36979747,  1293200.73868832,
        1293350.51418285,  1293497.03507672,  1293643.10710227,
        1293786.32434523,  1293923.62576877,  1294055.94065025,
        1294185.52730212,  1294309.87233172,  1294428.01029979,
        1294538.41601542,  1294643.53367802,  1294751.98530778,
        1294857.01472156,  1294955.42756991,  1295053.12427338,
        1295142.75421973,  1295226.57921488,  1295305.19910255,
        1295376.50237507,  1295436.86158517,  1295485.62913632,
        1295524.34064626,  1295554.15741053,  1295575.28434823,
        1295587.29005818,  1295588.8361973 ,  1295583.67142846,
        1295573.03458668,  1295557.02361738,  1295538.13699884,
        1295516.79212907,  1295490.49306137,  1295460.08183203,
        1295426.53880788,  1295389.39346109,  1295345.07748172,
        1295294.88157279,  1295236.96864844,  1295168.79356158,
        1295089.60419524,  1295000.81832538,  1294922.88589158,
        1294840.56754221,  1294753.49382479,  1294661.78439872,
        1294564.23739851,  1294476.33538784,  1294391.57461875,
        1294318.84993584,  1294243.2975131 ,  1294170.56363491,
        1294099.54687341,  1294030.55452032,  1293959.92389721,
        1293885.69234211,  1293806.37485205,  1293723.27202865,
        1293637.01261539,  1293547.61092741,  1293453.96600377,
        1293356.27941951,  1293255.21231751,  1293153.44468364,
        1293051.95047197,  1292964.4178695 ,  1292897.69696145,
        1292835.1569296 ,  1292774.65644203,  1292715.19416527,
        1292661.56276541,  1292620.11500924,  1292586.40931613,
        1292563.86983443,  1292542.52856069,  1292522.59612111,
        1292504.29343564,  1292487.93123142,  1292476.94263045,
        1292468.46658274,  1292462.40717408,  1292458.98412713,
        1292458.45139684,  1292465.02864146,  1292475.87652626,
        1292489.68248301,  1292506.43024212,  1292525.86691935,
        1292548.46738588,  1292573.61413044,  1292600.32392411,
        1292629.14794909,  1292660.69892802,  1292695.24996778,
        1292735.74842708,  1292781.80838127,  1292833.49859954,
        1292890.7489721 ,  1292953.37617695,  1293020.76831187,
        1293092.67781454,  1293170.8656888 ,  1293255.21493949,
        1293347.73698712,  1293451.60212838,  1293560.53883469,
        1293673.40404119,  1293791.83839225,  1293916.30298044,
        1294046.00774271,  1294179.47813611,  1294317.44649958,
        1294459.31051029,  1294604.38003481,  1294751.91001344,
        1294901.00742125,  1295051.22887492,  1295211.1760829 ,
        1295379.20617625,  1295548.95171368])

    ax11.plot(d_dx,AEP_dx,color='C1',alpha=0.5)
    ax11.set_xticks([2.5,3.5,4.5])
    ax11.set_xticklabels(['2.5D','3.5D','4.5D'])
    ax11.set_xlabel(r'$dx$',fontsize=8)

    ax12.plot(d_dy,AEP_dy,color='C1',alpha=0.5)
    ax12.set_xticks([2.5,3.5,4.5])
    ax12.set_xticklabels(['2.5D','3.5D','4.5D'])
    ax12.set_xlabel(r'$dy$',fontsize=8)

    ax13.plot(d_shear,AEP_shear,color='C1',alpha=0.5)
    ax13.set_xticks([1.,1.5,2.])
    ax13.set_xticklabels(['1D','1.5D','2D'])
    ax13.set_xlabel(r'$b$',fontsize=8)

    ax14.plot(d_rot,AEP_rot,color='C1',alpha=0.5)
    ax14.set_xticks([-10.,0.,10.])
    ax14.set_xticklabels([r'-30$^\circ$',r'0$^\circ$',r'30$^\circ$'])
    ax14.set_xlabel(r'$\theta$',fontsize=8)

    ax11.set_xlim(2.5,4.5)
    ax12.set_xlim(2.5,4.5)
    ax13.set_xlim(1.,2.)
    ax14.set_xlim(-10.,10.)

    ax11.set_yticks([1225000.,1275000.,1325000.])
    ax12.set_yticks([1225000.,1275000.,1325000.])
    ax13.set_yticks([1225000.,1275000.,1325000.])
    ax14.set_yticks([1225000.,1275000.,1325000.])

    ax11.set_yticklabels(['1225','1275','1325'])
    ax12.set_yticklabels(['','','',''])
    ax13.set_yticklabels(['','','',''])
    ax14.set_yticklabels(['','','',''])
    #
    ax11.set_ylim(1200000.,1350000.)
    ax12.set_ylim(1200000.,1350000.)
    ax13.set_ylim(1200000.,1350000.)
    ax14.set_ylim(1200000.,1350000.)

    ax11.set_ylabel('AEP (GWh)',fontsize=8)

    ax31.set_xlabel(r'$x_{50}$',fontsize=8)
    ax32.set_xlabel(r'$y_{50}$',fontsize=8)


    ax11.tick_params(axis='both', which='major', labelsize=8)
    ax11.tick_params(axis='both', which='minor', labelsize=8)
    ax12.tick_params(axis='both', which='major', labelsize=8)
    ax12.tick_params(axis='both', which='minor', labelsize=8)
    ax13.tick_params(axis='both', which='major', labelsize=8)
    ax13.tick_params(axis='both', which='minor', labelsize=8)
    ax14.tick_params(axis='both', which='major', labelsize=8)
    ax14.tick_params(axis='both', which='minor', labelsize=8)

    ax21.tick_params(axis='both', which='major', labelsize=8)
    ax21.tick_params(axis='both', which='minor', labelsize=8)
    ax22.tick_params(axis='both', which='major', labelsize=8)
    ax22.tick_params(axis='both', which='minor', labelsize=8)
    ax23.tick_params(axis='both', which='major', labelsize=8)
    ax23.tick_params(axis='both', which='minor', labelsize=8)
    ax24.tick_params(axis='both', which='major', labelsize=8)
    ax24.tick_params(axis='both', which='minor', labelsize=8)
    ax25.tick_params(axis='both', which='major', labelsize=8)
    ax25.tick_params(axis='both', which='minor', labelsize=8)

    ax31.tick_params(axis='both', which='major', labelsize=8)
    ax31.tick_params(axis='both', which='minor', labelsize=8)
    ax32.tick_params(axis='both', which='major', labelsize=8)
    ax32.tick_params(axis='both', which='minor', labelsize=8)

    loc = 0.1
    ax11.text(1.3,1350000.,'a',fontsize=11,color='black')
    ax21.text(1.4,1388000.,'b',fontsize=11,color='black')
    ax31.text(-6700.,1350200.,'c',fontsize=11,color='black')

    plt.subplots_adjust(top = 0.93, bottom = 0.1, right = 0.96, left = 0.1,
            hspace = 0.7, wspace = 1.0)

    plt.savefig('/Users/ningrsrch/Dropbox/Projects/stanley2019-variable-reduction/paper/paper-figures/multimodalityR1.pdf',transparent=True)
    plt.show()
