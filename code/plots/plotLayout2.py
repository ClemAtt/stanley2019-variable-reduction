import numpy as np
import matplotlib.pyplot as plt
import matplotlib
import sys
sys.path.insert(0, '/Users/ningrsrch/Dropbox/Projects/reduction/')
from position_constraints import *
import scipy as sp
from mpl_toolkits.axes_grid1.inset_locator import zoomed_inset_axes

"""colors"""
robin = '#B2DBD5'
nectar = '#EAB364'
tuscan = '#B2473E'
olive = '#ACBD78'

robin = 'C0'
nectar = 'C1'
tuscan = 'C2'
royal = 'C3'

nTurbs = 100
rotorDiameter = np.ones(nTurbs)*130.

spacing = 4.
side_length = (np.sqrt(nTurbs)-1.)*rotorDiameter[0]*spacing
a = side_length**2
circle_radius = np.sqrt(a/np.pi)



"""amalia boundary"""
locations = np.loadtxt('/Users/ningrsrch/Dropbox/Projects/reduction/layout_amalia.txt')
xBounds = locations[:, 0]
yBounds = locations[:, 1]
xBounds = xBounds - min(xBounds) - (max(xBounds)-min(xBounds))/2.
yBounds = yBounds - min(yBounds) - (max(yBounds)-min(yBounds))/2.
locations[:, 0] = xBounds
locations[:, 1] = yBounds
boundaryVertices, boundaryNormals = calculate_boundary(locations)
xBounds = boundaryVertices[:, 0]
yBounds = boundaryVertices[:, 1]

nBounds = len(xBounds)
points = np.zeros((nBounds,2))
points[:, 0] = xBounds
points[:, 1] = yBounds

hull = sp.spatial.ConvexHull(points)
area = hull.volume
area_ratio = area/(np.pi*circle_radius**2)
xBounds = xBounds/np.sqrt(area_ratio)
yBounds = yBounds/np.sqrt(area_ratio)
points[:, 0] = xBounds
points[:, 1] = yBounds

boundaryVertices, boundaryNormals = calculate_boundary(points)



startX = np.array([-1055.45573535,  -582.10981314,  -108.76389094,   364.58203126,
       -1356.51783135,  -883.17190915,  -409.82598695,    63.51993525,
         536.86585745,  1010.21177966, -1657.57992736, -1184.23400516,
        -710.88808296,  -237.54216076,   235.80376144,   709.14968365,
        1182.49560585,  1655.84152805, -1958.64202337, -1485.29610117,
       -1011.95017897,  -538.60425677,   -65.25833456,   408.08758764,
         881.43350984,  1354.77943204,  1828.12535424, -1786.35819718,
       -1313.01227498,  -839.66635278,  -366.32043057,   107.02549163,
         580.37141383,  1053.71733603,  1527.06325823,  2000.40918044,
       -2087.42029319, -1614.07437099, -1140.72844879,  -667.38252658,
        -194.03660438,   279.30931782,   752.65524002,  1226.00116223,
        1699.34708443,  2172.69300663, -1915.136467  , -1441.79054479,
        -968.44462259,  -495.09870039,   -21.75277819,   451.59314401,
         924.93906622,  1398.28498842,  1871.63091062, -2216.19856301,
       -1742.8526408 , -1269.5067186 ,  -796.1607964 ,  -322.8148742 ,
         150.531048  ,   623.87697021,  1097.22289241,  1570.56881461,
        2043.91473681, -2043.91473681, -1570.56881461, -1097.22289241,
        -623.87697021,  -150.531048  ,   322.8148742 ,   796.1607964 ,
        1269.5067186 ,  1742.8526408 ,  2216.19856301, -1871.63091062,
       -1398.28498842,  -924.93906622,  -451.59314401,    21.75277819,
         495.09870039,   968.44462259,  1441.79054479,  1915.136467  ,
       -2172.69300663, -1699.34708443, -1226.00116223,  -752.65524002,
        -279.30931782,   194.03660438,   667.38252658,  1140.72844879,
       -2000.40918044, -1527.06325823, -1053.71733603,  -580.37141383,
        -107.02549163,   366.32043057,  -881.43350984,  -408.08758764])
startY = np.array([-2.84007553e+03, -2.84007553e+03, -2.84007553e+03, -2.84007553e+03,
       -2.36672961e+03, -2.36672961e+03, -2.36672961e+03, -2.36672961e+03,
       -2.36672961e+03, -2.36672961e+03, -1.89338369e+03, -1.89338369e+03,
       -1.89338369e+03, -1.89338369e+03, -1.89338369e+03, -1.89338369e+03,
       -1.89338369e+03, -1.89338369e+03, -1.42003777e+03, -1.42003777e+03,
       -1.42003777e+03, -1.42003777e+03, -1.42003777e+03, -1.42003777e+03,
       -1.42003777e+03, -1.42003777e+03, -1.42003777e+03, -9.46691844e+02,
       -9.46691844e+02, -9.46691844e+02, -9.46691844e+02, -9.46691844e+02,
       -9.46691844e+02, -9.46691844e+02, -9.46691844e+02, -9.46691844e+02,
       -4.73345922e+02, -4.73345922e+02, -4.73345922e+02, -4.73345922e+02,
       -4.73345922e+02, -4.73345922e+02, -4.73345922e+02, -4.73345922e+02,
       -4.73345922e+02, -4.73345922e+02, -2.27373675e-13, -2.27373675e-13,
       -2.27373675e-13, -2.27373675e-13, -2.27373675e-13, -2.27373675e-13,
       -2.27373675e-13, -2.27373675e-13, -2.27373675e-13,  4.73345922e+02,
        4.73345922e+02,  4.73345922e+02,  4.73345922e+02,  4.73345922e+02,
        4.73345922e+02,  4.73345922e+02,  4.73345922e+02,  4.73345922e+02,
        4.73345922e+02,  9.46691844e+02,  9.46691844e+02,  9.46691844e+02,
        9.46691844e+02,  9.46691844e+02,  9.46691844e+02,  9.46691844e+02,
        9.46691844e+02,  9.46691844e+02,  9.46691844e+02,  1.42003777e+03,
        1.42003777e+03,  1.42003777e+03,  1.42003777e+03,  1.42003777e+03,
        1.42003777e+03,  1.42003777e+03,  1.42003777e+03,  1.42003777e+03,
        1.89338369e+03,  1.89338369e+03,  1.89338369e+03,  1.89338369e+03,
        1.89338369e+03,  1.89338369e+03,  1.89338369e+03,  1.89338369e+03,
        2.36672961e+03,  2.36672961e+03,  2.36672961e+03,  2.36672961e+03,
        2.36672961e+03,  2.36672961e+03,  2.84007553e+03,  2.84007553e+03])


gridX = np.array([ 2047.25688015,  2123.82634316,  1486.6907044 ,  1563.26016741,
       1639.82963042,  1716.39909343,  1792.96855644,  1869.53801945,
       1946.10748246,  2022.67694547,   926.12452865,  1002.69399166,
       1079.26345467,  1155.83291768,  1232.40238069,  1308.9718437 ,
       1385.54130671,  1462.11076972,  1538.68023273,  1615.24969574,
        442.12781591,   518.69727892,   595.26674193,   671.83620494,
        748.40566795,   824.97513096,   901.54459397,   978.11405698,
       1054.68351999,  1131.252983  ,  1207.82244601,    34.70056618,
        111.27002919,   187.8394922 ,   264.40895521,   340.97841822,
        417.54788123,   494.11734424,   570.68680725,   647.25627026,
        723.82573327,   800.39519628,  -449.29614656,  -372.72668355,
       -296.15722054,  -219.58775753,  -143.01829452,   -66.44883151,
         10.1206315 ,    86.69009451,   163.25955752,   239.82902053,
        316.39848354,   392.96794655,  -856.72339629,  -780.15393328,
       -703.58447027,  -627.01500726,  -550.44554425,  -473.87608124,
       -397.30661823,  -320.73715522,  -244.16769221,  -167.5982292 ,
        -91.02876619,   -14.45930318, -1264.15064602, -1187.58118301,
      -1111.01172   , -1034.44225699,  -957.87279398,  -881.30333097,
       -804.73386796,  -728.16440495,  -651.59494194,  -575.02547893,
       -498.45601592,  -421.88655291, -1595.00843274, -1518.43896973,
      -1441.86950672, -1365.30004371, -1288.7305807 , -1212.16111769,
      -1135.59165468, -1059.02219167,  -982.45272866,  -905.88326566,
      -1925.86621946, -1849.29675645, -1772.72729344, -1696.15783043,
      -1619.58836742, -1543.01890441, -1466.44944141, -1389.8799784 ,
      -2103.58508016, -2027.01561716, -1950.44615415, -1873.87669114])
gridY = np.array([-1174.01448807,  -686.71673588, -1900.92529891, -1413.62754672,
       -926.32979454,  -439.03204235,    48.26570984,   535.56346202,
       1022.86121421,  1510.1589664 , -2627.83610975, -2140.53835757,
      -1653.24060538, -1165.94285319,  -678.64510101,  -191.34734882,
        295.95040337,   783.24815555,  1270.54590774,  1757.84365993,
      -2867.44916841, -2380.15141622, -1892.85366403, -1405.55591185,
       -918.25815966,  -430.96040747,    56.33734471,   543.6350969 ,
       1030.93284909,  1518.23060127,  2005.52835346, -2619.76447487,
      -2132.46672269, -1645.1689705 , -1157.87121831,  -670.57346613,
       -183.27571394,   304.02203824,   791.31979043,  1278.61754262,
       1765.9152948 ,  2253.21304699, -2859.37753353, -2372.07978134,
      -1884.78202916, -1397.48427697,  -910.18652478,  -422.8887726 ,
         64.40897959,   551.70673178,  1039.00448396,  1526.30223615,
       2013.59998834,  2500.89774052, -2611.69284   , -2124.39508781,
      -1637.09733562, -1149.79958344,  -662.50183125,  -175.20407906,
        312.09367312,   799.39142531,  1286.6891775 ,  1773.98692968,
       2261.28468187,  2748.58243405, -2364.00814647, -1876.71039428,
      -1389.41264209,  -902.11488991,  -414.81713772,    72.48061447,
        559.77836665,  1047.07611884,  1534.37387103,  2021.67162321,
       2508.9693754 ,  2996.26712759, -1629.02570075, -1141.72794856,
       -654.43019637,  -167.13244419,   320.165308  ,   807.46306019,
       1294.76081237,  1782.05856456,  2269.35631675,  2756.65406893,
       -894.04325503,  -406.74550284,    80.55224934,   567.85000153,
       1055.14775372,  1542.4455059 ,  2029.74325809,  2517.04101028,
        815.53469506,  1302.83244725,  1790.13019944,  2277.42795162])










# freeX = np.array([ -262.87206551,  -597.83149827,  -300.13112769, -2000.06853475,
#        -1124.34364332,  -873.36271089,  1551.52216031, -1948.91644951,
#        -1659.06050584,   958.82565844, -1303.04840603, -1669.29737613,
#         -500.91902654, -2166.02497449, -2316.71835343,  1735.09145672,
#         1290.15662431,  -978.00319519,   -40.51728419, -1078.84240475,
#         -711.39412357,  -810.40186555,  -505.32146933,  1750.14262441,
#         -181.79997983,  1463.00967962,  1143.00749696,  1307.26671716,
#        -1831.00257045,  1491.65297402,   199.68133298, -1244.92735053,
#           69.30719481,  2076.85639488,  -628.00536061,  -160.14708796,
#         -236.19055323, -1002.66598389,   -76.23439457,  2316.96185909,
#         -948.35579252,   204.42631079,   133.34732631,   446.66304416,
#          532.59576903,  2289.2856904 ,  -588.36659776, -2250.24696005,
#         -814.12021924, -1047.98764749,   844.97149456,  -550.28486929,
#          532.96591242, -1290.73248196,  2048.89762842, -2332.02751921,
#          275.71188007,  1620.69397466,  1237.33610571,   982.82403998,
#          -31.37124242, -1649.55783045,  1214.82376051,  1081.94801971,
#         -113.78095896,  -228.14233491,   894.99434438, -1504.94882379,
#          273.74272749,  1951.6569641 ,  -688.83828227,   841.73996918,
#         1704.38395343,  1211.42482996, -1545.72267083,   721.70498439,
#          800.23734415, -1968.18137519,   878.99161043,  -925.864341  ,
#          969.06974955, -1192.74787827,  1395.09414085,   440.64560164,
#        -1232.51018777,  2212.83496474,  -403.81733908,  2333.41368554,
#          606.1741193 , -1931.16554738, -1220.0073038 , -1377.0342526 ,
#         -191.80979947,  2015.51673141, -1778.14516517, -2101.53929944,
#          633.1099796 ,  -952.62896678, -1410.51307641,  1779.40788959])
# freeY = np.array([ 2999.74563557,   322.9248775 , -2117.66025695, -1295.78516409,
#        -1454.1414571 ,  2604.26506689,  1817.22999586,  1868.65011379,
#         -577.2841842 ,   -71.21120084,  1897.08883736, -1173.66098955,
#         2520.38098671,  -502.21087626,  1416.43144772, -1221.94250226,
#          969.10593028,  1792.04696157,   138.90748002,   883.15433903,
#         -765.20428395, -1527.38957815,  -603.36291878, -1937.80589251,
#         1608.94846488,  1289.78990317,   703.10927842, -1472.94369238,
#          553.63405442, -1909.81817836, -2065.76304394, -2780.89615973,
#         -970.12144614,  -918.86736853, -2998.3848976 ,  2187.33607793,
#        -2995.51670119,   -96.41991046, -1879.87988665,  -198.29697717,
#        -2579.7030462 ,  1834.95544306,  2596.95680535, -2147.01729409,
#         1109.27617551,   467.21427885,  1672.50076992,    61.88056192,
#        -2038.74415999, -2991.08085783,  -631.57599252, -2046.78221397,
#        -1198.18492503,  1366.43549351, -1470.70355263,   685.41878152,
#         -437.35386116,  -138.40515354, -2449.77175378, -1657.3010069 ,
#        -2571.59262599,   -91.47251306,  2036.67024647,  -754.65932742,
#          853.95300485,  -255.54069156,  1064.38562088,  2657.49601593,
#         1084.87346417,   160.04399727,  2215.99117668, -2376.25712013,
#          678.00964781, -1893.01982851, -2189.33202979, -1863.10488211,
#         1497.65096514,  2389.18968368,  2255.54592638,  -994.29631711,
#          344.91436938,   546.58382156,  -815.44213676,  -133.7882117 ,
#         2603.71979369,   957.47488707, -1594.00693845,  -996.5100179 ,
#           98.13737135,  1375.67208974, -1942.90394107,   263.94195877,
#         -842.96723401,  1514.8255739 , -1732.2344576 ,  -934.11493241,
#        -2795.48876408,  2977.14127487, -1363.01535069,  1405.95518612])


freeX = np.array([  1.58530781e+03,  -2.14591001e+02,  -2.43110763e+02,
       -1.39670323e+03,  -1.42895436e+03,  -1.17070183e+03,
       -5.42558988e+01,   5.94667024e+02,  -1.73493120e+03,
       -1.12806953e+03,   1.64304192e+02,   9.73105736e+02,
       -1.71613727e+03,   1.90205047e+03,  -1.96267998e+03,
       -1.82805480e+02,  -1.30274585e+03,  -2.25906874e+03,
       -4.95527659e+02,   1.18797725e+03,  -4.79032210e+02,
       -1.53828880e+03,   6.21562755e+02,  -8.09947358e+02,
        6.13658356e+02,   1.54111509e+03,   1.87446591e+03,
       -4.18713463e+02,  -2.25695492e+03,  -6.32401840e+02,
       -5.33472503e+02,  -1.07570814e+03,  -1.61886489e+03,
       -6.17525250e+02,   1.70548028e+03,   8.57446502e+02,
        1.37514560e+03,   7.46061557e+02,   3.13893314e+02,
        1.70862365e+02,   2.32761475e+03,   1.78472255e+03,
       -1.96824258e+03,  -1.87008810e+03,  -3.85014142e+02,
       -2.08838566e+00,  -1.63745936e+03,   2.97700477e+02,
       -1.08204537e+03,   1.08065275e+03,   2.00418784e+03,
        1.54016268e+01,   1.29847462e+03,   5.85353546e+02,
        2.00633248e+03,  -1.09476456e+03,   5.25195014e+02,
        1.13174364e+03,  -9.74949261e+02,  -1.32461596e+02,
       -1.38710007e+03,   6.82861014e+02,   2.31080644e+03,
        9.36502906e+01,  -1.47958384e+03,  -2.10181283e+03,
       -1.26108186e+03,   8.22445560e+02,  -1.31672790e+03,
        1.67419144e+03,   1.08055287e+02,   1.95449600e+03,
       -2.04465984e+03,   1.96126314e+03,   2.15873741e+03,
       -1.62863348e+03,  -2.68676133e+02,  -2.19356195e+03,
        1.40420980e+03,  -2.31604576e+03,  -7.34819560e+02,
       -8.20575619e+02,  -8.41294848e+02,   1.32032508e+03,
       -1.03848939e+03,   8.90442806e+02,   1.02866545e+03,
        4.84666559e+02,  -1.78153539e+03,  -1.43443893e+03,
        2.22200970e+03,  -6.20741643e+02,   7.62509818e+02,
       -3.88008725e+02,  -2.32656201e+03,   1.11594669e+03,
       -7.07892496e+02,   1.48582357e+03,   2.03875198e+02,
        1.21560917e+02])
freeY = np.array([ -875.002023  ,  2354.65766992, -1454.82084686,  2720.19925426,
        -68.46668251,  1823.64564396,  1471.52545019,  2418.77104631,
       2274.38230746, -1659.3821344 ,   937.57990617,  -209.25535613,
      -1216.43001868,   395.98128579, -1369.3159889 , -2502.02799829,
       -764.86730783,  1886.78852601,   371.97521392, -1081.16978083,
       1783.96185329,   620.08076479, -1402.90192086,  1000.84382314,
        616.04810007,  1824.01271622,  -951.12412075,  -230.71721037,
        226.74615147,  2988.68099115, -1717.84690455,  2865.5239486 ,
       1557.06472818,  -670.97111098, -2005.12304899,  -861.96672359,
      -2370.92199353,  1665.34089032, -2977.18057228,  2717.06299658,
       -714.96196807,  1665.24367071,  2389.12463547,   -35.10649483,
      -3000.47748748,  -143.41953479, -1960.89098221,  1695.99489889,
       1167.59599424,  2124.11503299,  1522.20908219, -2987.13029518,
       1982.15153036, -2312.08027727,   -30.42017173, -2990.26734634,
        -38.90124027,   902.42522378,  -603.25236054,  -860.90503303,
      -1441.25522722,  1219.09281034,   100.24083076,  2150.42326341,
       2225.41573344,  -932.28291497, -2749.12561707,  2292.39932219,
      -2087.24593047,   141.35186571,  -990.37030081, -1628.03960085,
       1281.6939538 ,   866.31877992, -1105.20012421,  -550.08801664,
       3001.78822382,  -211.15234509,   765.3424477 ,  1448.54801388,
       1929.61128822,  2551.71247467, -1806.11433214,  -320.10400964,
        436.45860268, -1714.2128856 ,   333.2523099 ,  -746.49269099,
        744.17424641, -2408.19004731,  1380.24557956, -2337.68601187,
      -2721.45071218,  1127.87336433,   946.39664533, -2314.56246082,
      -2916.0997092 , -1451.12656559, -1617.80715547, -2158.94931725])


parX = np.array([ 1814.32636691,  1492.39527294,  1170.46417897,   848.533085  ,
        526.60199103,   204.67089706,  -117.26019691,  -472.56508962,
       -856.58434569, -1202.04996311, -1534.55975903, -1867.06955495,
      -2102.19303402, -2294.72549922, -2316.1252446 , -2324.17098866,
      -2332.21673271, -2285.15911946, -2228.41468649, -2171.67025352,
      -2114.92582054, -2039.3663333 , -1865.19790464, -1691.02947598,
      -1516.86104732, -1342.69261866, -1168.52419   ,  -820.09111861,
       -435.88069978,   -51.8219279 ,   330.05326887,   663.58592365,
        997.11857843,  1330.65123321,  1610.53540592,  1822.97819102,
       2029.04288475,  2226.74740626,  2329.77228923,  2321.85091061,
       2313.92953199,  2299.20190714,  2270.96393807,  2242.72596901,
       2136.25746088,   624.63651281,   357.46056661,    90.28462042,
       -176.89132577,  -444.06727197,  -711.24321816,  1842.40934665,
       1575.23340046,  1308.05745426,  1040.88150807,   773.70556188,
        506.52961568,   239.35366949,   -27.8222767 ,  -294.9982229 ,
       -562.17416909,  -829.35011528, -1096.52606148, -1363.70200767,
      -1630.87795387,  1991.47839572,  1724.30244953,  1457.12650333,
       1189.95055714,   922.77461095,   655.59866475,   388.42271856,
        121.24677237,  -145.92917383,  -413.10512002,  -680.28106621,
       -947.45701241, -1214.6329586 , -1481.8089048 , -1748.98485099,
       1606.1955524 ,  1339.01960621,  1071.84366002,   804.66771382,
        537.49176763,   270.31582144,     3.13987524,  -264.03607095,
       -531.21201715,  -798.38796334, -1065.56390953, -1332.73985573,
      -1599.91580192,   419.38487051,   152.20892431,  -114.96702188,
       -382.14296808,  -649.31891427,  -916.49486046, -1183.67080666])
parY = np.array([ 1645.9496423 ,  1855.76542992,  2065.58121753,  2275.39700514,
       2485.21279275,  2695.02858037,  2904.84436798,  2994.44087404,
       2980.60234229,  2832.95572181,  2640.34334003,  2447.73095825,
       2157.75566136,  1825.19958512,  1444.75239427,  1060.56811558,
        676.38383688,   295.71083893,   -84.3448982 ,  -464.40063533,
       -844.45637245, -1218.4994936 , -1561.03073664, -1903.56197967,
      -2246.0932227 , -2588.62446574, -2931.15570877, -2995.04427572,
      -3001.72619605, -2989.37108034, -2968.88719135, -2778.05149712,
      -2587.21580289, -2396.38010866, -2148.22836674, -1828.02474863,
      -1503.79479207, -1174.28725623,  -819.60283881,  -435.41597573,
        -51.22911266,   332.63705175,   715.8666319 ,  1099.09621205,
       1436.13385469,  1748.92657775,  1861.73097919,  1974.53538063,
       2087.33978207,  2200.14418351,  2312.94858495,   228.44327081,
        341.24767225,   454.05207369,   566.85647513,   679.66087658,
        792.46527802,   905.26967946,  1018.0740809 ,  1130.87848234,
       1243.68288378,  1356.48728522,  1469.29168667,  1582.09608811,
       1694.90048955,  -840.82243036,  -728.01802892,  -615.21362748,
       -502.40922604,  -389.6048246 ,  -276.80042316,  -163.99602171,
        -51.19162027,    61.61278117,   174.41718261,   287.22158405,
        400.02598549,   512.83038694,   625.63478838,   738.43918982,
      -1684.47932865, -1571.67492721, -1458.87052577, -1346.06612433,
      -1233.26172289, -1120.45732144, -1007.65292   ,  -894.84851856,
       -782.04411712,  -669.23971568,  -556.43531424,  -443.6309128 ,
       -330.82651135, -2189.72302262, -2076.91862118, -1964.11421973,
      -1851.30981829, -1738.50541685, -1625.70101541, -1512.89661397])


# fig = plt.subplot2grid((2, 4), figsize=[6.5,5.])
# fig = plt.figure(figsize=[6.5,5.])
import matplotlib as mpl
mpl.rc('font', family = 'serif', serif = 'cmr10')
plt.rcParams["mathtext.fontset"] = "dejavuserif"

fig = plt.figure(figsize=[6.5,3.3])
ax1 = plt.subplot2grid((1, 4), (0, 0))
ax2 = plt.subplot2grid((1, 4), (0, 1))
ax4 = plt.subplot2grid((1, 4), (0, 2))
ax3 = plt.subplot2grid((1, 4), (0, 3))

bx = boundaryVertices[:,0]
by = boundaryVertices[:,1]
bx = np.append(bx,bx[0])
by = np.append(by,by[0])
ax1.plot(bx,by,'--k',linewidth=0.5)
ax2.plot(bx,by,'--k',linewidth=0.5)
ax3.plot(bx,by,'--k',linewidth=0.5)
ax4.plot(bx,by,'--k',linewidth=0.5)

ax1.axis('equal')
ax1.axis('off')
ax2.axis('equal')
ax2.axis('off')
ax3.axis('equal')
ax3.axis('off')
ax4.axis('equal')
ax4.axis('off')


for i in range(nTurbs):
    circ = plt.Circle((startX[i],startY[i]), rotorDiameter[i]/2.,facecolor=robin,edgecolor=robin,alpha=0.5)
    ax1.add_patch(circ)


for i in range(nTurbs):
    circ = plt.Circle((gridX[i],gridY[i]), rotorDiameter[i]/2.,facecolor=robin,edgecolor=robin,alpha=0.5)
    ax2.add_patch(circ)


for i in range(nTurbs):
    circ = plt.Circle((freeX[i],freeY[i]), rotorDiameter[i]/2.,facecolor=robin,edgecolor=robin,alpha=0.5)
    ax3.add_patch(circ)

for i in range(nTurbs):
    circ = plt.Circle((parX[i],parY[i]), rotorDiameter[i]/2.,facecolor=robin,edgecolor=robin,alpha=0.5)
    ax4.add_patch(circ)




ax1.text(-2500.,2700.,'a',fontsize=11,color='black')
ax2.text(-2500.,2700.,'b',fontsize=11,color='black')
ax3.text(-2500.,2700.,'d',fontsize=11,color='black')
ax4.text(-2500.,2700.,'c',fontsize=11,color='black')

ax1.text(-500.,-3600.,'baseline',fontsize=8)
ax2.text(-500.,-3600.,'grid',fontsize=8)
ax4.text(-500.,-3600.,'BG',fontsize=8)
ax3.text(-500.,-3600.,'direct',fontsize=8)


plt.subplots_adjust(top = 1, bottom = 0, right = 1, left = 0,
            hspace = 0, wspace = 0)
# plt.tight_layout()
plt.savefig('/Users/ningrsrch/Dropbox/Projects/reduction/paper/paper-figures/opt-cases.pdf')
plt.show()
